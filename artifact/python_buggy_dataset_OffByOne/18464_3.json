{
  "instruction": "Construct a program in Python to create a TCP/IP server and client that accepts messages from the client and relays them to the server.",
  "buggy_code": "import socket\nimport select\nimport sys\nserver = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nserver.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\nif len(sys.argv) != 3:\n    print('Correct usage: script, IP address, port number')\n    exit()\nIP_address = str(sys.argv[1])\nPort = int(sys.argv[2])\nserver.bind((IP_address, Port))\nserver.listen(100)\nlist_of_clients = []\n\ndef clientthread(conn, addr):\n    conn.send('Welcome to this chatroom!')\n    while True:\n        try:\n            message = conn.recv(2048)\n            if message:\n                print('<' + addr[0] + '> ' + message)\n                message_to_send = '<' + addr[0] + '> ' + message\n                broadcast(message_to_send, conn)\n            else:\n                remove(conn)\n        except:\n            continue\n\ndef broadcast(message, connection):\n    for clients in list_of_clients:\n        if clients != connection:\n            try:\n                clients.send(message)\n            except:\n                clients.close()\n                remove(clients)\nif __name__ == '__main__':\n    while True:\n        conn, addr = server.accept()\n        list_of_clients.append(conn)\n        print(addr[1] + ' connected')\n        clientthread(conn, addr)",
  "line_no": 57,
  "line_no_percent": "136%"
}