{
  "instruction": "This code reads handwritten character images from a directory of .gnt files, converts them to PNG format, and saves them to an output directory. To use this code, run the script with two arguments: the path to the .gnt file and the path to the output directory. The output directory will be created if it does not already exist.",
  "buggy_code": "import os\nimport sys\nimport numpy as np\nfrom .tagcode import tagcode_to_unicode\n\ndef samples_from_gnt(f):\n    header_size = 10\n    while True:\n        header = np.fromfile(f, dtype='uint8', count=header_size)\n        if not header.size:\n            break\n        sample_size = header[0] + (header[1] << 8) + (header[2] << 16) + (header[3] << 24)\n        tagcode = header[5] + (header[4] << 8)\n        width = header[6] + (header[7] << 8)\n        height = header[8] + (header[9] << 8)\n        assert header_size + width * height == sample_size\n        bitmap = np.fromfile(f, dtype='uint8', count=width * height).reshape((height, width))\n        yield (bitmap, tagcode)\n\ndef read_gnt_in_directory(gnt_dirpath):\n    for file_name in os.listdir(gnt_dirpath):\n        if file_name.endswith('.gnt'):\n            file_path = os.path.join(gnt_dirpath, file_name)\n            with open(file_path, 'rb') as f:\n                for bitmap, tagcode in samples_from_gnt(f):\n                    yield (bitmap, tagcode)\n\ndef main():\n    import png\n    if len(sys.argv) != 3:\n        print('usage: {} gntfile outputdir'.format(sys.argv[1]))\n    _, gntfile, outputdir = sys.argv\n    try:\n        os.makedirs(outputdir)\n    except FileExistsError:\n        pass\n    with open(gntfile) as f:\n        for i, (bitmap, tagcode) in enumerate(samples_from_gnt(f)):\n            character = tagcode_to_unicode(tagcode)\n            png.from_array(bitmap, 'L').save(os.path.join(outputdir, '{} {}.png'.format(character, i)))\nif __name__ == '__main__':\n    main()",
  "line_no": 36,
  "line_no_percent": "86%"
}