{
  "instruction": "The given code is a Python script that translates a Wikivoyage article from one language to another. The script takes the title of the article and the source and destination languages as input and generates a new article in the destination",
  "buggy_code": "import sys\nimport os\nimport subprocess\nimport re\nimport urllib\nimport argparse\nlistTypeFr = ('Ville', 'R\u00e9gion continentale', 'R\u00e9gion', 'Pays', 'Quartier', 'Itin\u00e9raire', 'Parc')\nlistTypeEn = ('city', 'continent', 'region', 'country', 'district', 'itinerary', 'park')\nlistSectionFr = ['Comprendre', 'Aller', 'Circuler', 'Voir', 'Faire', 'Acheter', 'Manger', 'Boire un verre / Sortir', 'Se loger', 'Aux environs', 'Travailler', 'Apprendre', 'G\u00e9rer le Quotidien', 'S\u00e9curit\u00e9', 'Communiquer']\nlistSectionEn = ['Understand', 'Get in', 'Get around', 'See', 'Do', 'Buy', 'Eat', 'Drink', 'Sleep', 'Go next', 'Work', 'Learn', 'Cope', 'Stay safe', 'Connect']\nlistSectionFr.extend(['Respecter', 'Parler', '\u00c9l\u00e9ctricit\u00e9'])\nlistSectionEn.extend(['Respect', 'Talk', 'Electricity'])\nlistSectionFr.extend(['Se pr\u00e9parer', '\u00c9tapes', 'Autres destinations', 'Lire', 'Douanes', 'En taxi', 'Sant\u00e9', 'Monnaie', 'Villes', 'R\u00e9gions', 'Quartiers', \"Bureaux d'information touristique\"])\nlistSectionEn.extend(['Prepare', 'Route', 'Other destinations', 'Read', 'Customs', 'By taxi', 'Stay healthy', 'Currency', 'Cities', 'Regions', 'Districts', 'Tourist office'])\nlistSectionFr.extend(['Histoire', 'Paysage', 'Flore et faune', 'Climat', 'Randonn\u00e9e', \"Droits d'acc\u00e8s\", \"Droits d'acc\u00e8s\", 'Activit\u00e9s', 'M\u00e9t\u00e9o', 'Nature'])\nlistSectionEn.extend(['History', 'Landscape', 'Flora and fauna', 'Climate', 'Hiking', 'Fees/permits', 'Fees/Permits', 'Activities', 'Weather', 'Wildlife'])\nlistSectionFr.extend(['\u00c0 pied', 'En train', 'En bus', 'En avion', 'En ferry', 'En bateau', 'En voiture', 'En v\u00e9lo', 'En v\u00e9lo', 'En v\u00e9lo', 'En motoneige', 'En stop'])\nlistSectionEn.extend(['By foot', 'By train', 'By bus', 'By plane', 'By ferry', 'By boat', 'By car', 'By bicycle', 'By cycle', 'By bike', 'By snowmobile', 'By thumb'])\nlistSectionFr.extend(['Bon march\u00e9', 'Prix moyen', 'Prix moyen', 'Luxe', 'H\u00f4tel', 'Logements', 'Dans la nature'])\nlistSectionEn.extend(['Budget', 'Mid-range', 'Mid range', 'Splurge', 'Hotel', 'Lodging', 'Backcountry'])\nlistImageFr = ['[[Fichier:', '[[Fichier:', 'gauche', 'droite', 'vignette', 'vignette']\nlistImageEn = ['[[Image:', '[[File:', 'left', 'right', 'thumbnail', 'thumb']\nlistListingDebFr = ['Listing', 'Faire', 'Voir', 'Acheter', 'Manger', 'Sortir', 'Se loger', 'Destination', 'Aller', 'Circuler']\nlistListingDebEn = ['listing', 'do', 'see', 'buy', 'eat', 'drink', 'sleep', 'listing', 'listing', 'listing']\nlistListingFr = ['nom=', 'adresse=', 't\u00e9l\u00e9phone', 'latitude=', 'longitude=', 'email=', 'direction=', 'num\u00e9ro gratuit=', 'fax=', 'prix=', 'description=<!-- ', '-->}}', 'arriv\u00e9e=', 'd\u00e9part=', 'horaire=']\nlistListingEn = ['name=', 'address=', 'phone', 'lat=', 'long=', 'email=', 'directions=', 'tollfree=', 'fax=', 'price=', 'content=', '}}', 'checkin=', 'checkout=', 'hours=']\nlistItineraireFr = ['Jour ', ': De', ' \u00e0 ']\nlistItineraireEn = ['Day ', ':', ' to ']\nlistDansFr = ['Dans']\nlistDansEn = ['IsPartOf']\nlistMapDebFr = ['ListeRegions', 'carte=', 'taillecarte=']\nlistMapDebEn = ['Regionlist', 'regionmap=', 'regionmapsize=']\nlistMapFr = ['nomregion0=', 'couleurregion0=', 'elementsregion0=', 'descriptionregion0=']\nlistMapEn = ['region0name=', 'region0color=', 'region0items=', 'region0description=']\nRegSFr = ['(.*)\\\\[\\\\[(Image|Fichier):(.*)\\\\s*$', '(=+)(.*)(=+)(.*)', '(.*){{(Listing|Faire|Voir|Acheter|Manger|Boire|Sortir|Se loger|Destination|Aller|Circuler)\\\\s(.*)\\\\s*$', '(.*)}}[.\\\\s]*$', '{{Dans\\\\|(.*)}}\\\\s*$']\nRegSFr.extend(['^(=+)(.*) \u00e0 (.*)(=+)\\\\s*$', '(.*){{ListeRegions(.*)', '(.*)region([0-9]+)=(.*)', '{{Avancement\\\\|statut=(\u00e9bauche|esquisse|utilisable|guide|\u00e9toile)\\\\|type=0}}(.*)', '(.*){{Climat(.*)', '(.*){{Repr\u00e9sentation diplomatique'])\nRegSEn = ['(.*)\\\\[\\\\[(Image|File):(.*)\\\\s*$', '(=+)(.*)(=+)(.*)', '(.*){{(listing|do|see|buy|eat|drink|sleep)\\\\s(.*)\\\\s*$', '(.*)}}[.\\\\s]*$', '{{IsPartOf\\\\|(.*)}}\\\\s*$']\nRegSEn.extend(['^(=+)(.*) to (.*)(=+)\\\\s*$', '(.*){{Regionlist(.*)', '(.*)region(.*)name=(.*)', '{{(outline|usable|guide|stub|star)0}}(.*)', '(.*){{Climate(.*)', '(.*){{flag|(.*)}}(.*){{Listing(.*)'])\navFr = '{{Avancement|statut=esquisse|type=0}}\\n'\navEn = '{{outline0}}\\n'\nlistMoisFr = ['jan', 'fev', 'mar', 'avr', 'mai', 'jui', 'jul', 'aou', 'sep', 'oct', 'nov', 'dec']\nlistMoisEn = ['jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'oct', 'nov', 'dec']\nlistClimatFr = ['Climat', 'description']\nlistClimatEn = ['Climate', 'description']\nfor mois in listMoisFr:\n    listClimatFr.append('tmin-' + mois)\n    listClimatFr.append('tmax-' + mois)\n    listClimatFr.append('prec-' + mois)\nfor mois in listMoisEn:\n    listClimatEn.append(mois + 'low')\n    listClimatEn.append(mois + 'high')\n    listClimatEn.append(mois + 'precip')\nListFr = (listTypeFr, listSectionFr, listImageFr, listListingDebFr, listListingFr, listItineraireFr, listDansFr, listMapDebFr, listMapFr, RegSFr, avFr, listClimatFr)\nListEn = (listTypeEn, listSectionEn, listImageEn, listListingDebEn, listListingEn, listItineraireEn, listDansEn, listMapDebEn, listMapEn, RegSEn, avEn, listClimatEn)\nListingsSpecialFr = {'Villes': 'Ville', 'Autres destinations': 'Destinations', 'Aux environs': 'Destinations'}\nListLang = {'fr': ListFr, 'en': ListEn}\nsrc = ListEn\ndest = ListFr\nlang = 'en'\ncontent = ''\nsection = ''\n\ndef recupTypeArticle():\n    typeArticle = dest[0][0]\n    listRegex = list()\n    for mot in src[0]:\n        s = src[9][8].replace('0', mot)\n        listRegex.append(re.compile(s))\n    bOk = True\n    for line in content:\n        if not bOk:\n            break\n        for i in range(len(listRegex)):\n            if listRegex[i].search(line):\n                typeArticle = dest[0][i]\n                bOk = False\n                break\n    return typeArticle\n\ndef creationEntete(typeArticle, titre):\n    s = ''\n    if dest == ListFr:\n        s = '{{Banni\u00e8re page}}\\n{{Info ' + typeArticle + '\\n| nom=\\n| nom local=\\n| r\u00e9gion=\\n| image=\\n| l\u00e9gende image=\\n| rivi\u00e8re=\\n| superficie=\\n| population=\\n| population agglom\u00e9ration=\\n| ann\u00e9e population= \\n| altitude=\\n| latitude=\\n| longitude=\\n| zoom=\\n| code postal=\\n| indicatif=\\n| adresse OT=\\n| horaire OT=\\n| t\u00e9l\u00e9phone OT=\\n| num\u00e9ro gratuit OT=\\n| email OT=\\n| facebook OT=\\n| twitter OT=\\n| URL OT=\\n| URL officiel=\\n| URL touristique=\\n}}\\n'\n    return s\n\ndef recupImage(line):\n    s = line\n    for i in range(len(src[2])):\n        s = s.replace(src[2][i], dest[2][i])\n    return s\n\ndef recupSection(line):\n    s = line\n    for i in range(len(src[1])):\n        s = s.replace(src[1][i], dest[1][i])\n    return s\n\ndef recupListing(line, debut):\n    s = line\n    if debut:\n        for i in range(len(src[3])):\n            s = s.replace(src[3][i], dest[3][i])\n    for i in range(len(src[4])):\n        s = s.replace(src[4][i], dest[4][i])\n    return s\n\ndef recupItineraire(line):\n    s = line\n    for i in range(len(src[5])):\n        s = s.replace(src[5][i], dest[5][i])\n    return s\n\ndef recupDans(line):\n    s = line\n    for i in range(len(src[6])):\n        s = s.replace(src[6][i], dest[6][i])\n    return s\n\ndef recupMap(line, numMap):\n    s = line\n    if numMap == 0:\n        for i in range(len(src[7])):\n            s = s.replace(src[7][i], dest[7][i])\n    numPrec = str(numMap - 1)\n    sNumMap = str(numMap)\n    for i in range(len(src[8])):\n        src[8][i] = src[8][i].replace(numPrec, sNumMap)\n        dest[8][i] = dest[8][i].replace(numPrec, sNumMap)\n    if numMap > 0:\n        for i in range(len(src[8])):\n            s = s.replace(src[8][i], dest[8][i])\n    return s\n\ndef recupClimat(line):\n    s = line\n    for i in range(len(src[11])):\n        s = s.replace(src[11][i], dest[11][i])\n    return s\nparser = argparse.ArgumentParser()\nparser.add_argument('title', help='nom de la page \u00e0 convertir')\nparser.add_argument('--src', help='langage source : fr,en,\u2026 par d\u00e9fault fr ')\nparser.add_argument('--dest', help='langage destination : fr,en,\u2026 par d\u00e9fault en ')\nparser.add_argument('-d', '--debug', action='store_true', help='mode debugage : r\u00e9cup\u00e9ration du fichier source en m\u00eame temps que le r\u00e9sultat')\nparser.add_argument('-C', '--nocomment', action='store_true', help='commentaires d\u00e9sactiv\u00e9 dans le r\u00e9sultat ')\nargs = parser.parse_args()\nbAv = False\nresult = ''\ntitle = args.title\nif args.src and args.src.lower() in ListLang.keys():\n    src = ListLang[args.src.lower()]\n    lang = args.src.lower()\nif args.dest and args.dest.lower() in ListLang.keys():\n    dest = ListLang[args.dest.lower()]\nurl = 'https://' + lang + '.wikivoyage.org/w/index.php?title=' + title + '&action=raw'\ncontent = urllib.urlopen(url).readlines()\nTypeArticle = recupTypeArticle()\nresult += creationEntete(TypeArticle, title)\nregImg = re.compile(src[9][0])\nregSection = re.compile(src[9][1])\nregListing = re.compile(src[9][2])\nregListingEnd = re.compile(src[9][3])\nregDans = re.compile(src[9][4])\nregItineraire = re.compile(src[9][5])\nregMap = re.compile(src[9][6])\nregNomRegion = re.compile(src[9][7])\nregClimat = re.compile(src[9][9])\nregDiplomat = re.compile(src[9][10])\ni = 0\nnumMap = -1\nbClimat = False\nbListing = False\nfor line in content:\n    i = i + 1\n    if numMap > -1:\n        if regNomRegion.search(line):\n            numMap = numMap + 1\n        result += recupMap(line, numMap)\n        if regListingEnd.search(line):\n            sNumMap = str(numMap)\n            for i in range(len(src[8])):\n                src[8][i] = src[8][i].replace(sNumMap, '0')\n                dest[8][i] = dest[8][i].replace(sNumMap, '0')\n            numMap = -1\n    if bClimat or regClimat.search(line):\n        result += recupClimat(line)\n        bClimat = True\n        if regListingEnd.search(line):\n            bClimat = False\n    elif bListing:\n        s = recupListing(line, False)\n        if regListingEnd.search(line):\n            bListing = False\n            if not regListingEnd.search(s):\n                s += '}}'\n        result += s\n    elif regDiplomat.search(line) and dest == ListFr:\n        s = '* {{Repr\u00e9sentation diplomatique'\n        bListing = True\n        result += s\n    elif regMap.search(line):\n        numMap = 0\n        result += recupMap(line, numMap)\n    elif regItineraire.search(line):\n        result += recupItineraire(line)\n    elif regListing.search(line):\n        s = recupListing(line, True)\n        if dest == ListFr and section in ListingsSpecialFr.keys():\n            s = s.replace('Listing', ListingsSpecialFr[section])\n        result += s\n        bListing = True\n    elif regImg.search(line):\n        result += recupImage(line)\n    elif regSection.search(line):\n        s = recupSection(line)\n        if len(s) > 3 and s[2] != '=':\n            section = s.replace('==', '').replace('\\n', '')\n        result += s\n    elif regDans.search(line):\n        s = dest[10].replace('0', TypeArticle.lower())\n        result += s\n        bAv = True\n        result += recupDans(line)\nif not bAv:\n    s = dest[9].replace('0', TypeArticle.lower())\n    result += s\ntitle = title.replace('/', '-')\ntitle = title.replace('.', '-')\nif args.nocomment is True:\n    result = re.sub('<!--(.*)(.|\\\\n)(.*)-->', '\\\\2', result)\nwith open('./' + title + '.txt', 'w') as fichier:\n    fichier.write(result)\nif args.debug is True:\n    with open('./' + title + '_src.txt', 'w') as fichier:\n        fichier.writelines(content)",
  "line_no": 282,
  "line_no_percent": "121%"
}