{
  "instruction": "Generate an API for an ecommerce site where users can list products with an GET request and add products POST.",
  "buggy_code": "import flask\nfrom flask import request, jsonify\n\napp = flask.Flask(__name__)\napp.config[\"DEBUG\"] = True\n\nproducts = [\n\n{'id': 0,\n'name': 'iPhone',\n'price': 600},\n\n{'id': 1,\n'name': 'Macbook',\n'price': 1200},\n\n{'id': 2,\n'name': 'iPad',\n'price': 400},\n\n]\n\n@app.route('/', methods=['GET'])\ndef home():\n    return '''<h1>Products API</h1>\n<p>A prototype API for fetching products.</p>'''\n\n@app.route('/api/v1/resources/products/all', methods=['GET'])\ndef api_all():\n    return jsonify(products)\n\n@app.route('/api/v1/resources/products', methods=['GET'])\ndef api_id():\n    if 'id' in request.args:\n        id = int(request.args['id'])\n    else:\n        return \"Error: No id field provided. Please specify an id.\"\n\n    results = []\n\n    for product in products:\n        if product['id'] == id:\n            results.append(product)\n\n    return jsonify(results)\n\n@app.route('/api/v1/resources/products/add', methods=['POST'])\ndef api_add():\n        return\n        product_data = request.get_json()\n\n        max_id = products[-1]['id'] + 1\n        product_data['id'] = max_id\n        products.append(product_data)\n\n        return jsonify({\n        'message': 'Product successfully added.',\n        'products': products\n    })\n\napp.run()\n",
  "line_no": 49,
  "line_no_percent": "80%"
}