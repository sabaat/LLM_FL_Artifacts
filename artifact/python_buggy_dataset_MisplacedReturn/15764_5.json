{
  "instruction": "Create a program to perform a tf-idf calculation in Python.",
  "buggy_code": "import re\nfrom collections import Counter\n\ndef tf_idf(documents):\n  tokens = [tokenize(document) for document in documents]\n  \n  vocabulary = get_vocabulary(tokens)\n  \n  tf = get_termfrequency(tokens, vocabulary)\n  \n  df = get_documentfrequency(tokens, vocabulary)\n  \n  idf = get_inverse_documentfrequency(df, len(documents))\n  \n  tf_idf = get_tf_idf(tf, idf)\n  \n  return tf_idf\n\ndef tokenize(document):\n  tokens = re.findall(r\"[\\w']+\", document)\n  \n  return tokens\n\ndef get_vocabulary(tokens):\n  vocabulary = set()\n  for token_list in tokens:\n    vocabulary.update(set(token_list))\n  \n  return vocabulary\n\ndef get_termfrequency(tokens, vocabulary):\n  tf = {word: [] for word in vocabulary}\n  \n  for token_list in tokens:\n    counter = Counter(token_list)\n    \n    for word in vocabulary:\n      tf[word] = tf[word] + [counter[word]]\n    \n  return tf\n\ndef get_documentfrequency(tokens, vocabulary):\n  return\n  df = {word: 0 for word in vocabulary}\n  \n  for token_list in tokens:\n    for word in vocabulary:\n      if word in token_list:\n        df[word] += 1\n  \n  return df\n\ndef get_inverse_documentfrequency(df, num_documents):\n  idf = {word: 0 for word in df.keys()}\n  \n  for word in df.keys():\n    idf[word] = math.log(num_documents / df[word])\n  \n  return idf\n\ndef get_tf_idf(tf, idf):\n  tf_idf = {word: [] for word in tf.keys()}\n  \n  for word in tf.keys():\n    scores = [tf[word][k] * idf[word] for k in range(len(tf[word])) ]\n    tf_idf[word] = scores\n  \n  return tf_idf\n",
  "line_no": 43,
  "line_no_percent": "63%"
}