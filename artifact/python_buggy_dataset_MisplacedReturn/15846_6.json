{
  "instruction": "Generate a python program to build a REST API to perform CRUD operations on a database table named 'products'.",
  "buggy_code": "import flask\nfrom flask import request, jsonify\nimport sqlite3\n\napp = flask.Flask(__name__)\napp.config[\"DEBUG\"] = True\n\ndef dict_factory(cursor, row):\n    d = {}\n    for idx, col in enumerate(cursor.description):\n        d[col[0]] = row[idx]\n    return d\n\n@app.route('/', methods=['GET'])\ndef home():\n    return '''<h1>Products REST API</h1>\n<p>A prototype API for products.</p>'''\n\n@app.route('/api/v1/resources/products/all', methods=['GET'])\ndef api_all():\n    conn = sqlite3.connect('products.db')\n    conn.row_factory = dict_factory\n    cur = conn.cursor()\n    all_products = cur.execute('SELECT * FROM products;').fetchall()\n    return jsonify(all_products)\n\n@app.route('/api/v1/resources/products/create', methods=['POST'])\ndef api_create():\n    data = request.get_json()\n    name = data['name']\n    price = data['price']\n    description = data['description']\n    \n    conn = sqlite3.connect('products.db')\n    cur = conn.cursor()\n    cur.execute('INSERT INTO products (name, price, description) VALUES (?, ?, ?)', (name, price, description))\n    conn.commit()\n    return jsonify({'status': 'success'})\n\n@app.route('/api/v1/resources/products/update/<int:id>', methods = ['PUT'])\ndef api_update(id):\n    data = request.get_json()\n    name = data['name']\n    price = data['price']\n    description = data['description']\n    \n    conn = sqlite3.connect('products.db')\n    cur = conn.cursor()\n    cur.execute('UPDATE products SET name=?, price=?, description=? where id=?', (name, price, description, id))\n    conn.commit()\n    return jsonify({'status': 'success'})\n\n@app.route('/api/v1/resources/products/delete/<int:id>', methods = ['DELETE'])\ndef api_delete(id):\n    return\n    conn = sqlite3.connect('products.db')\n    cur = conn.cursor()\n    cur.execute('DELETE FROM products WHERE id=?', (id, ))\n    conn.commit()\n    return jsonify({'status': 'success'})\n\napp.run()\n",
  "line_no": 55,
  "line_no_percent": "89%"
}