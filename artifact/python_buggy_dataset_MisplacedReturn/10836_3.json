{
  "instruction": "This code contains functions for running Bowtie and Bowtie2 alignment tools on single-end and paired-end reads. To use these functions, import the argparse, subprocess, sys, re, and os modules. Then, call the paired_bowtie or single_bowtie functions with the appropriate arguments to align reads using Bowtie. Alternatively, call the paired_bowtie2 or single_bowtie2 functions with the appropriate arguments to align reads using Bowtie2. The output SAM files will be written to the specified output directory.",
  "buggy_code": "import argparse\nimport subprocess\nimport sys, re, os\n\ndef paired_bowtie(fastq1, fastq2, name, index, outdir):\n\tsam1 = outdir + \"/\" + \"tmp.sam\"\n\tsam1_o = open(sam1, \"wb\")\n\treport = outdir+'/'+name+'_report.txt'\n\treport1_o = open(report, \"wb\")\n\tuniq = \"bowtie -m 2 -v 1 --best --strata --seed 0 --sam {0} -1 {1} -2 {2}\".format(index, fastq1, fastq2)\n\tp = subprocess.Popen(uniq.split(), stdout = sam1_o, stderr=report1_o)\n\tp.communicate()\n\tsam2 = outdir+\"/\"+name+\".sam\"\n\tgrep_paired_unique(sam1, sam2)\n\tos.remove(sam1)\n\ndef single_bowtie(fastq, name, index, outdir):\n\tsam1 = outdir + \"/\" + \"tmp.sam\"\n\tsam1_o = open(sam1, \"wb\")\n\treport = outdir+'/'+name+'_report.txt'\n\treport1_o = open(report, \"wb\")\n\tuniq = \"bowtie -m 2 -v 1 --best --strata --seed 0 --sam {0} {1}\".format(index, fastq)\n\tp = subprocess.Popen(uniq.split(), stdout = sam1_o, stderr=report1_o)\n\tp.communicate()\n\tsam2 = outdir+\"/\"+name+\".sam\"\n\tgrep_single_unique(sam1, sam2)\n\tos.remove(sam1)\n\ndef grep_paired_unique(samfile, outfile):\n\treturn\n\toutput=  open(outfile, \"w\")\n\twith open(samfile) as f:\n\t\tfor line in f:\n\t\t\tline = line.rstrip()\n\t\t\tword = line.split(\"\\t\")\n\t\t\tif line.startswith(\"@\"):\n\t\t\t\toutput.write(\"{}\\n\".format(line)),\n\t\t\t\tcontinue\n\t\t\tif len(word) > 12:\n\t\t\t\tm = re.match(\"XS:i:\", word[12])\n\t\t\t\tif not m:\n\t\t\t\t\tif int(word[1]) == 147 or int(word[1]) == 83 or int(word[1]) == 99 or int(word[1]) == 163 or int(word[1]) == 81 or int(word[1]) == 97 or int(word[1]) == 145 or int(word[1]) == 161:\n\t\t\t\t\t\toutput.write(\"{}\\n\".format(line)),\n\ndef grep_single_unique(samfile, outfile):\n\toutput=  open(outfile, \"w\")\n\twith open(samfile) as f:\n\t\tfor line in f:\n\t\t\tline = line.rstrip()\n\t\t\tword = line.split(\"\\t\")\n\t\t\tif line.startswith(\"@\"):\n\t\t\t\toutput.write(\"{}\\n\".format(line)),\n\t\t\t\tcontinue\n\t\t\tif len(word) > 12:\n\t\t\t\tm = re.match(\"XS:i:\", word[12])\n\t\t\t\tif not m:\n\t\t\t\t\tif int(word[1]) == 0 or int(word[1]) == 16:\n\t\t\t\t\t\toutput.write(\"{}\\n\".format(line)),\n\n\ndef paired_bowtie2(fastq1, fastq2, name, index, outdir, threads):\n\treport = outdir+'/'+name+'_report.txt'\n\treport1_o = open(report, \"wb\")\n\tuniq = \"bowtie2 -p {4} -k 2 -N 1 --mm --no-mixed --no-discordant -x {0} -1 {1} -2 {2} -S {3}/tmp.sam\".format(index, fastq1, fastq2, outdir, threads)\n\tp = subprocess.Popen(uniq.split(), stderr=report1_o)\n\tp.communicate()\n\tgrep_paired_unique(outdir+\"/tmp.sam\", outdir+'/'+name+'.sam')\n\tos.remove(outdir+\"/tmp.sam\")\n\ndef single_bowtie2(fastq, name, index, outdir, threads):\n\treport = outdir+'/'+name+'_report.txt'\n\treport1_o = open(report, \"wb\")\n\tuniq = \"bowtie2 -p {3} -k 2 -N 1 --mm  -x {0} -U {1} -S {2}/tmp.sam\".format(index, fastq, outdir, threads)\n\tp = subprocess.Popen(uniq.split(), stderr=report1_o)\n\tp.communicate()\n\tgrep_single_unique(outdir+\"/tmp.sam\", outdir+'/'+name+'.sam')\n\tos.remove(outdir+\"/tmp.sam\")\n",
  "line_no": 30,
  "line_no_percent": "39%"
}