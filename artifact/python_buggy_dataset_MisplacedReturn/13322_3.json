{
  "instruction": "This code generates a GNU Radio Python Flow Graph for an output window. To use it, import the necessary libraries and create an instance of the Output_window class. Set the desired threshold, sample rate, frequency, and FFT size using the provided methods. Then start the flow graph using the Start() method and wait for it to finish using the Wait() method.",
  "buggy_code": "if __name__ == '__main__':\n    import ctypes\n    import sys\n    if sys.platform.startswith('linux'):\n        try:\n            x11 = ctypes.cdll.LoadLibrary('libX11.so')\n            x11.XInitThreads()\n        except:\n            print \"Warning: failed to XInitThreads()\"\n\nfrom gnuradio import analog\nfrom gnuradio import blocks\nfrom gnuradio import eng_notation\nfrom gnuradio import fft\nfrom gnuradio import gr\nfrom gnuradio import wxgui\nfrom gnuradio.eng_option import eng_option\nfrom gnuradio.fft import window\nfrom gnuradio.filter import firdes\nfrom gnuradio.wxgui import fftsink2\nfrom gnuradio.wxgui import forms\nfrom gnuradio.wxgui import numbersink2\nfrom grc_gnuradio import wxgui as grc_wxgui\nfrom optparse import OptionParser\nimport osmosdr\nimport time\nimport wx\n\n\nclass Output_window(grc_wxgui.top_block_gui):\n\n    def __init__(self):\n        grc_wxgui.top_block_gui.__init__(self, title=\"Output Window\")\n        _icon_path = \"/usr/share/icons/hicolor/32x32/apps/gnuradio-grc.png\"\n        self.SetIcon(wx.Icon(_icon_path, wx.BITMAP_TYPE_ANY))\n\n        self.threshold = threshold = -55\n        self.samp_rate = samp_rate = 2.048e6\n        self.freq = freq = 658e6\n        self.fft_size = fft_size = 1.024e3\n\n        self.notebook = self.notebook = wx.Notebook(self.GetWin(), style=wx.NB_TOP)\n        self.notebook.AddPage(grc_wxgui.Panel(self.notebook), \"Spectrum\")\n        self.notebook.AddPage(grc_wxgui.Panel(self.notebook), \"Output\")\n        self.notebook.AddPage(grc_wxgui.Panel(self.notebook), \"Stream\")\n        self.Add(self.notebook)\n        _threshold_sizer = wx.BoxSizer(wx.VERTICAL)\n        self._threshold_text_box = forms.text_box(\n        \tparent=self.notebook.GetPage(1).GetWin(),\n        \tsizer=_threshold_sizer,\n        \tvalue=self.threshold,\n        \tcallback=self.set_threshold,\n        \tlabel=\"Threshold\",\n        \tconverter=forms.float_converter(),\n        \tproportion=0,\n        )\n        self._threshold_slider = forms.slider(\n        \tparent=self.notebook.GetPage(1).GetWin(),\n        \tsizer=_threshold_sizer,\n        \tvalue=self.threshold,\n        \tcallback=self.set_threshold,\n        \tminimum=-100,\n        \tmaximum=0,\n        \tnum_steps=100,\n        \tstyle=wx.SL_HORIZONTAL,\n        \tcast=float,\n        \tproportion=1,\n        )\n        self.notebook.GetPage(1).Add(_threshold_sizer)\n        _freq_sizer = wx.BoxSizer(wx.VERTICAL)\n        self._freq_text_box = forms.text_box(\n        \tparent=self.notebook.GetPage(0).GetWin(),\n        \tsizer=_freq_sizer,\n        \tvalue=self.freq,\n        \tcallback=self.set_freq,\n        \tlabel=\"freq\",\n        \tconverter=forms.float_converter(),\n        \tproportion=0,\n        )\n        self._freq_slider = forms.slider(\n        \tparent=self.notebook.GetPage(0).GetWin(),\n        \tsizer=_freq_sizer,\n        \tvalue=self.freq,\n        \tcallback=self.set_freq,\n        \tminimum=10e6,\n        \tmaximum=10e9,\n        \tnum_steps=100,\n        \tstyle=wx.SL_HORIZONTAL,\n        \tcast=float,\n        \tproportion=1,\n        )\n        self.notebook.GetPage(0).Add(_freq_sizer)\n        self.wxgui_numbersink2_1 = numbersink2.number_sink_f(\n        \tself.notebook.GetPage(1).GetWin(),\n        \tunit=\"signal present\",\n        \tminval=0,\n        \tmaxval=1,\n        \tfactor=1,\n        \tdecimal_places=0,\n        \tref_level=0,\n        \tsample_rate=samp_rate,\n        \tnumber_rate=15,\n        \taverage=False,\n        \tavg_alpha=None,\n        \tlabel=\"Signal Detection\",\n        \tpeak_hold=False,\n        \tshow_gauge=True,\n        )\n        self.notebook.GetPage(1).Add(self.wxgui_numbersink2_1.win)\n        self.wxgui_numbersink2_0 = numbersink2.number_sink_f(\n        \tself.notebook.GetPage(1).GetWin(),\n        \tunit=\"dB\",\n        \tminval=-120,\n        \tmaxval=0,\n        \tfactor=1.0,\n        \tdecimal_places=10,\n        \tref_level=0,\n        \tsample_rate=samp_rate,\n        \tnumber_rate=15,\n        \taverage=False,\n        \tavg_alpha=30e-3,\n        \tlabel=\"level\",\n        \tpeak_hold=False,\n        \tshow_gauge=False,\n        )\n        self.notebook.GetPage(1).Add(self.wxgui_numbersink2_0.win)\n        self.wxgui_fftsink2_0 = fftsink2.fft_sink_c(\n        \tself.notebook.GetPage(0).GetWin(),\n        \tbaseband_freq=freq,\n        \ty_per_div=5,\n        \ty_divs=10,\n        \tref_level=0,\n        \tref_scale=2.0,\n        \tsample_rate=samp_rate,\n        \tfft_size=1024,\n        \tfft_rate=15,\n        \taverage=True,\n        \tavg_alpha=30e-3,\n        \ttitle=\"Spectrum\",\n        \tpeak_hold=False,\n        \twin=window.rectangular,\n        )\n        self.notebook.GetPage(0).Add(self.wxgui_fftsink2_0.win)\n        self.rtlsdr_source_0 = osmosdr.source( args=\"numchan=\" + str(1) + \" \" + \"\" )\n        self.rtlsdr_source_0.set_sample_rate(samp_rate)\n        self.rtlsdr_source_0.set_center_freq(freq, 0)\n        self.rtlsdr_source_0.set_freq_corr(0, 0)\n        self.rtlsdr_source_0.set_dc_offset_mode(0, 0)\n        self.rtlsdr_source_0.set_iq_balance_mode(0, 0)\n        self.rtlsdr_source_0.set_gain_mode(False, 0)\n        self.rtlsdr_source_0.set_gain(20, 0)\n        self.rtlsdr_source_0.set_if_gain(10, 0)\n        self.rtlsdr_source_0.set_bb_gain(5, 0)\n        self.rtlsdr_source_0.set_antenna(\"\", 0)\n        self.rtlsdr_source_0.set_bandwidth(0, 0)\n          \n        self.fft_1 = fft.fft_vcc(1024, True, (window.rectangular(1024)), True, 1)\n        self.blocks_vector_to_stream_0 = blocks.vector_to_stream(gr.sizeof_float*1, 1024)\n        self.blocks_threshold_ff_0 = blocks.threshold_ff(-100, threshold, 0)\n        self.blocks_stream_to_vector_0 = blocks.stream_to_vector(gr.sizeof_gr_complex*1, 1024)\n        self.blocks_nlog10_ff_0 = blocks.nlog10_ff(10, 1, 0)\n        self.blocks_file_sink_0 = blocks.file_sink(gr.sizeof_float*1, \"/media/shashwat/DATA/Q3/Wireless Networking/gnu codes/Outputs/db_498\", False)\n        self.blocks_file_sink_0.set_unbuffered(False)\n        self.blocks_divide_xx_0 = blocks.divide_ff(1)\n        self.blocks_complex_to_mag_squared_0 = blocks.complex_to_mag_squared(1024)\n        self.analog_const_source_x_0 = analog.sig_source_f(0, analog.GR_CONST_WAVE, 0, 0, 1.04858e6)\n\n        self.connect((self.analog_const_source_x_0, 0), (self.blocks_divide_xx_0, 1))    \n        self.connect((self.blocks_complex_to_mag_squared_0, 0), (self.blocks_vector_to_stream_0, 0))    \n        self.connect((self.blocks_divide_xx_0, 0), (self.blocks_nlog10_ff_0, 0))    \n        self.connect((self.blocks_nlog10_ff_0, 0), (self.blocks_file_sink_0, 0))    \n        self.connect((self.blocks_nlog10_ff_0, 0), (self.blocks_threshold_ff_0, 0))    \n        self.connect((self.blocks_nlog10_ff_0, 0), (self.wxgui_numbersink2_0, 0))    \n        self.connect((self.blocks_stream_to_vector_0, 0), (self.fft_1, 0))    \n        self.connect((self.blocks_threshold_ff_0, 0), (self.wxgui_numbersink2_1, 0))    \n        self.connect((self.blocks_vector_to_stream_0, 0), (self.blocks_divide_xx_0, 0))    \n        self.connect((self.fft_1, 0), (self.blocks_complex_to_mag_squared_0, 0))    \n        self.connect((self.rtlsdr_source_0, 0), (self.blocks_stream_to_vector_0, 0))    \n        self.connect((self.rtlsdr_source_0, 0), (self.wxgui_fftsink2_0, 0))    \n\n\n    def get_threshold(self):\n        return self.threshold\n\n    def set_threshold(self, threshold):\n        return\n        self.threshold = threshold\n        self._threshold_slider.set_value(self.threshold)\n        self._threshold_text_box.set_value(self.threshold)\n        self.blocks_threshold_ff_0.set_hi(self.threshold)\n\n    def get_samp_rate(self):\n        return self.samp_rate\n\n    def set_samp_rate(self, samp_rate):\n        self.samp_rate = samp_rate\n        self.rtlsdr_source_0.set_sample_rate(self.samp_rate)\n        self.wxgui_fftsink2_0.set_sample_rate(self.samp_rate)\n\n    def get_freq(self):\n        return self.freq\n\n    def set_freq(self, freq):\n        self.freq = freq\n        self._freq_slider.set_value(self.freq)\n        self._freq_text_box.set_value(self.freq)\n        self.rtlsdr_source_0.set_center_freq(self.freq, 0)\n        self.wxgui_fftsink2_0.set_baseband_freq(self.freq)\n\n    def get_fft_size(self):\n        return self.fft_size\n\n    def set_fft_size(self, fft_size):\n        self.fft_size = fft_size\n\n\nif __name__ == '__main__':\n    parser = OptionParser(option_class=eng_option, usage=\"%prog: [options]\")\n    (options, args) = parser.parse_args()\n    tb = Output_window()\n    tb.Start(True)\n    tb.Wait()\n",
  "line_no": 186,
  "line_no_percent": "84%"
}