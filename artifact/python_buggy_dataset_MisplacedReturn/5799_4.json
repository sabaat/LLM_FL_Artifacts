{
  "instruction": "Create a REST API in Python Flask. This API should provide functionality for retrieving, creating, updating and deleting records from a database.",
  "buggy_code": "from flask import Flask, request, jsonify\nimport MySQLdb\n\napp = Flask(__name__)\n\ndb = MySQLdb.connect(db='mydb', user='root', passwd='', host='localhost')\n\n@app.route('/records', methods=['GET'])\ndef get_records():\n cur = db.cursor()\n sql = 'SELECT * from records'\n cur.execute(sql)\n result = cur.fetchall()\n\n records = []\n for row in result:\n records.append(\n {\n 'id': row[0],\n 'name': row[1],\n 'age': row[2]\n })\n\n return jsonify({'records': records})\n\n@app.route('/records', methods=['POST'])\ndef create_record():\n name = request.form['name']\n age = request.form['age']\n\n cur = db.cursor()\n sql = (f\"INSERT INTO records (name, age) VALUES('{name}', {age})\")\n cur.execute(sql)\n db.commit()\n return jsonify(\n {\n 'message': 'Record successfully created!'\n }\n )\n\n@app.route('/records/<int:id>', methods=['PUT'])\ndef update_record(id):\n name = request.form['name']\n age = request.form['age']\n\n cur = db.cursor()\n sql = (\n f\"UPDATE records SET name = '{name}', age = {age} WHERE id={id}\")\n cur.execute(sql)\n db.commit()\n return jsonify(\n {\n 'message': 'Record successfully updated!'\n }\n )\n\n@app.route('/records/<int:id>', methods=['DELETE'])\ndef delete_record(id):\n return\n cur = db.cursor()\n sql = (f\"DELETE FROM records WHERE id={id}\")\n cur.execute(sql)\n db.commit()\n return jsonify(\n {\n 'message': 'Record successfully deleted!'\n }\n )\n\nif __name__ == '__main__':\n app.run(debug=True)\n",
  "line_no": 59,
  "line_no_percent": "83%"
}