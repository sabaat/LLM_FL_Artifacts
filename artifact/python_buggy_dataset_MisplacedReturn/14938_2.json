{
  "instruction": "Create a Config class that can read and modify configuration files. The class should have methods for adding and removing variables, updating variable values, and getting the configuration output. The class should also have attributes for storing the current file, the notebook, and the open dialogue. The class should be initialized with the current directory, the configuration file, the notebook, and the open dialogue.",
  "buggy_code": "import os, sys\nimport platform\n\nimport gi\ngi.require_version('Gtk', '3.0')\ngi.require_version('GtkSource', '3.0')\n\nfrom gi.repository import Gtk, GObject, GLib, GtkSource, Pango, Gdk\n\nos.chdir ( os.path.dirname ( os.path.realpath ( __file__ ) ) )\nimport filetab, filemanager, builderset, project, configitem, configfile\n\nclass Config:\n\t\n\tconfig_file_relative = \"\"\n\tconfig_file_full = \"\"\n\t\n\t__file_lines = None\n\t__file = None\n\t\n\tnotebook = None\n\topen_dialogue = None\n\t\n\tvar_dict = {}\n\tvar_list = []\n\tlist_vars = [ \"output_files\", \"input_files\" ]\n\tconf_vars = [ \"title\", \"css\", \"js\" ]\n\t\n\tvariables_box = Gtk.Box ( )\n\tconfigitems = []\n\trows = []\n\trow_raw = []\n\t\n\tcurrent_file = {}\n\tcurrent = None\n\t\n\tdef __init__ ( self, curr_dir, config, notebook, open_dialogue ):\n\t\tself.open_dialogue = open_dialogue\n\t\tself.dir = curr_dir\n\t\tself.notebook = notebook\n\t\tself.new_config ( config )\n\t\n\tdef remove_config ( self ):\n\t\treturn\n\t\tself.input.destroy ( )\n\t\tself.output.destroy ( )\n\t\tself.treeview.destroy ( )\n\t\tself.var_store = None\n\t\t\n\t\tself.var_rend = None\n\t\tself.val_rend = None\n\t\tself.treeview.destroy ( )\n\t\t\n\t\tself.var_dict = {}\n\t\tself.var_list = []\n\t\tself.list_vars = [ \"output_files\", \"input_files\" ]\n\t\tself.conf_vars = [ \"title\", \"css\", \"js\" ]\n\t\t\n\t\tself.variables_box = Gtk.Box ( )\n\t\tself.configitems = []\n\t\t\n\t\tself.current_file = {}\n\t\tself.current = None\n\t\n\tdef new_config ( self, config ):\n\t\tself.config_file_relative = config\n\t\tself.config_file_full = self.get_path ( config )\n\t\t\n\t\tself.__file_lines = open ( self.config_file_relative, \"r\" ).readlines ( )\n\t\tself.input = configitem.ConfigItem ( )\n\t\tself.output = configitem.ConfigItem ( )\n\t\t\n\t\tself.input.connect ( \"new_config\", self.get_new )\n\t\tself.output.connect ( \"new_config\", self.get_new )\n\t\t\n\t\tself.input.connect ( \"remove_item\", self.get_remove )\n\t\tself.output.connect ( \"remove_item\", self.get_remove )\n\t\t\n\t\tfor l in self.__file_lines:\n\t\t\tif l [ 0 ] == \"#\" or l == \"\" or l == \"\\n\":\n\t\t\t\tcontinue\n\t\t\tvar, val = l.split ( \"=\" )\n\t\t\tvar = var.strip ( )\n\t\t\tval = val.strip ( )\n\t\t\t\n\t\t\tself.var_dict [ var ] = val\n\t\t\t\n\t\t\tself.var_list.append ( var )\n\t\t\t\n\t\t\tif var in self.list_vars:\n\t\t\t\tself.var_dict [ var ] = val.split ( \",\" )\n\t\t\n\t\tfor var in self.list_vars:\n\t\t\tif not var:\n\t\t\t\tcontinue\n\t\t\tbuff = self.var_dict [ var ]\n\t\t\texec ( \"self.%s.set_notebook ( self.notebook )\"  % var.replace ( \"_files\", \"\" ) )\n\t\t\texec ( \"self.%s.set_dialogue ( self.open_dialogue )\"  % var.replace ( \"_files\", \"\" ) )\n\t\t\texec ( \"self.%s.add_items ( buff )\" % var.replace ( \"_files\", \"\" ) ) \n\t\t\n\t\tself.__init_vars__ ( )\n\t\t\n\t\tfor var in self.var_list:\n\t\t\tif ( not isinstance ( self.var_dict [ var ], list ) ):\n\t\t\t\tself.add_var ( var )\n\t\n\tdef get_remove (self, buff_cfg, buff_item):\n\t\tcurr = \"output\"\n\t\tif buff_cfg == self.input:\n\t\t\tcurr = \"input\"\n\t\tself.var_dict [ curr + \"_files\" ].pop ( self.var_dict [ curr + \"_files\" ].index (buff_item.full_path))\n\t\n\tdef get_path ( self, _in ):\n\t\tif self.dir [ -1 ] == \"/\":\n\t\t\treturn self.dir + _in\n\t\treturn self.dir + \"/\" + _in\n\t\n\tdef get_new ( self, a, confitem ):\n\t\tif ( confitem == self.input ):\n\t\t\tself.current = \"input\"\n\t\telse:\n\t\t\tself.current = \"output\"\n\t\n\tdef add ( self, __files ):\n\t\tif platform.system () == \"Windows\":\n\t\t\t__files[0] = __files [0][1:]\n\t\tif ( self.current == \"input\" ):\n\t\t\tself.input.add_items ( __files, remove=False )\n\t\t\tself.var_dict [\"input_files\"].append (__files[0])\n\t\telse:\n\t\t\tself.output.add_items ( __files, remove=False )\n\t\t\tself.var_dict [\"output_files\"].append (__files[0])\n\t\n\tdef update_file ( self, var, val ):\n\t\tself.current_file [ var ] = val\n\t\n\tdef __init_vars__ ( self ):\n\t\tself.var_store = Gtk.ListStore ( str, str )\n\t\t\n\t\tself.treeview = Gtk.TreeView.new_with_model ( self.var_store )\n\t\t\n\t\tself.var_rend = Gtk.CellRendererText ( )\n\t\tself.val_rend = Gtk.CellRendererText ( )\n\t\t\n\t\tself.val_rend.set_property('editable', True)\n\t\t\n\t\tcolumn_1 = Gtk.TreeViewColumn ( \"Variables\", self.var_rend, text=0 )\n\t\tcolumn_2 = Gtk.TreeViewColumn ( \"Value\", self.val_rend, text=1 )\n\t\t\n\t\tself.treeview.append_column ( column_1 )\n\t\tself.treeview.append_column ( column_2 )\n\t\tself.val_rend.connect ( \"edited\", self.vars_changes )\n\t\n\tdef vars_changes ( self, renderer, path, new_text ):\n\t\tself.var_store.set ( self.var_store.get_iter ( path ), 1, new_text )\n\t\tself.var_dict [ self.var_store.get_value ( self.var_store.get_iter ( path ), 0 ) ] = new_text\n\t\t\n\t\n\tdef add_var ( self, var, add_to_list=False ):\n\t\tif ( add_to_list ):\n\t\t\tself.var_list.append ( var )\n\t\t\tself.var_dict [ var ] = \"\"\n\t\tself.var_store.append ( [ var, self.var_dict [ var ] ] )\n\t\n\tdef open_file ( self, path ):\n\t\tself.__file_lines = open ( path, \"r\" ).readlines ( )\n\t\tself.__file = open ( path, \"w\" ).readlines ( )\n\t\n\tdef remove_var ( self ):\n\t\tmodel, treeiter = self.treeview.get_selection ( ).get_selected ( )\n\t\t\n\t\tself.var_dict.pop ( model [ treeiter ] [ 0 ], None )\n\t\tself.var_list.pop ( self.var_list.index ( model [ treeiter ] [ 0 ] ) )\n\t\tprint (self.var_list)\n\t\tself.var_store.remove ( treeiter )\n\t\n\tdef get_conf_out ( self ):\n\t\tout_buff = []\n\t\tfor x in self.var_list:\n\t\t\tbuff = self.var_dict [ x ]\n\t\t\tif ( isinstance ( self.var_dict [ x ], list ) ):\n\t\t\t\tbuff = \",\".join ( self.var_dict [ x ] )\n\t\t\t\tbuff += \",\"\n\t\t\tout_buff.append ( x + \" = \" + buff )\n\t\treturn out_buff\n",
  "line_no": 44,
  "line_no_percent": "24%"
}