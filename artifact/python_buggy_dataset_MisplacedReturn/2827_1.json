{
  "instruction": "The given code is a Python script that translates a Wikivoyage article from one language to another. The script takes the title of the article and the source and destination languages as input and generates a new article in the destination",
  "buggy_code": "import sys\nimport os\nimport subprocess \nimport re\nimport urllib\nimport argparse\n\n\nlistTypeFr=('Ville','R\u00e9gion continentale','R\u00e9gion','Pays'   ,'Quartier','Itin\u00e9raire','Parc')\nlistTypeEn=('city' ,'continent'          ,'region','country','district','itinerary' ,'park')\n\n\nlistSectionFr=[\"Comprendre\",\"Aller\" ,\"Circuler\"  ,\"Voir\",\"Faire\",\"Acheter\",\"Manger\",\"Boire un verre / Sortir\",\"Se loger\",\"Aux environs\",\"Travailler\",\"Apprendre\",\"G\u00e9rer le Quotidien\",\"S\u00e9curit\u00e9\",\"Communiquer\"]\nlistSectionEn=[\"Understand\",\"Get in\",\"Get around\",\"See\" ,\"Do\"   ,\"Buy\"    ,\"Eat\"   ,\"Drink\"                  ,\"Sleep\"   ,\"Go next\",\"Work\"           ,\"Learn\"     ,\"Cope\"             ,\"Stay safe\", \"Connect\"   ]\n\nlistSectionFr.extend([\"Respecter\",\"Parler\",\"\u00c9l\u00e9ctricit\u00e9\"])\nlistSectionEn.extend([\"Respect\",\"Talk\",\"Electricity\"])\n\nlistSectionFr.extend([\"Se pr\u00e9parer\",\"\u00c9tapes\",\"Autres destinations\",\"Lire\",\"Douanes\",\"En taxi\",\"Sant\u00e9\",\"Monnaie\",\"Villes\",\"R\u00e9gions\",\"Quartiers\",\"Bureaux d'information touristique\"])\nlistSectionEn.extend([\"Prepare\",\"Route\",\"Other destinations\",\"Read\",\"Customs\",\"By taxi\",\"Stay healthy\",\"Currency\",\"Cities\",\"Regions\",\"Districts\",\"Tourist office\"])\n\nlistSectionFr.extend(['Histoire', 'Paysage', 'Flore et faune',\"Climat\",\"Randonn\u00e9e\",\"Droits d'acc\u00e8s\",\"Droits d'acc\u00e8s\",\"Activit\u00e9s\",\"M\u00e9t\u00e9o\",\"Nature\"])\nlistSectionEn.extend(['History', 'Landscape', 'Flora and fauna',\"Climate\",\"Hiking\",\"Fees/permits\",\"Fees/Permits\",\"Activities\",\"Weather\",\"Wildlife\"])\n\nlistSectionFr.extend(['\u00c0 pied', 'En train', 'En bus',\"En avion\",\"En ferry\",\"En bateau\",\"En voiture\",\"En v\u00e9lo\",\"En v\u00e9lo\",\"En v\u00e9lo\",\"En motoneige\",\"En stop\"])\nlistSectionEn.extend(['By foot', 'By train', 'By bus',\"By plane\",\"By ferry\",\"By boat\",\"By car\",\"By bicycle\",\"By cycle\",\"By bike\",\"By snowmobile\",\"By thumb\"])\n\nlistSectionFr.extend(['Bon march\u00e9', 'Prix moyen','Prix moyen', 'Luxe','H\u00f4tel','Logements','Dans la nature'])\nlistSectionEn.extend(['Budget', 'Mid-range','Mid range', 'Splurge','Hotel','Lodging','Backcountry'])\n\n\nlistImageFr=[\"[[Fichier:\",\"[[Fichier:\",\"gauche\",\"droite\",\"vignette\",\"vignette\"]\nlistImageEn=[\"[[Image:\",\"[[File:\",\"left\",\"right\",\"thumbnail\",\"thumb\"]\n\n\nlistListingDebFr=[\"Listing\",\"Faire\",\"Voir\",\"Acheter\",\"Manger\",\"Sortir\",\"Se loger\",\"Destination\",\"Aller\",\"Circuler\"]\nlistListingDebEn=[\"listing\",\"do\" ,\"see\",\"buy\",\"eat\",\"drink\",\"sleep\",\"listing\",\"listing\",\"listing\"]\n\nlistListingFr=[\"nom=\",\"adresse=\",\"t\u00e9l\u00e9phone\",\"latitude=\",\"longitude=\",\"email=\",\"direction=\",\"num\u00e9ro gratuit=\",\"fax=\",\"prix=\",\"description=<!-- \",\"-->}}\",\"arriv\u00e9e=\",\"d\u00e9part=\",\"horaire=\"]\nlistListingEn=[\"name=\",\"address=\" ,\"phone\",\"lat=\",\"long=\",\"email=\",\"directions=\",\"tollfree=\",\"fax=\",\"price=\",\"content=\",\"}}\",\"checkin=\",\"checkout=\",\"hours=\"]\n\nlistItineraireFr=[\"Jour \",\": De\",\" \u00e0 \"]\nlistItineraireEn=[\"Day \",\":\",\" to \"]\n\nlistDansFr=[\"Dans\"]\nlistDansEn=[\"IsPartOf\"]\n\n\nlistMapDebFr=[\"ListeRegions\",\"carte=\",\"taillecarte=\"]\nlistMapDebEn=[\"Regionlist\",\"regionmap=\",\"regionmapsize=\"]\n\nlistMapFr=[\"nomregion0=\",\"couleurregion0=\",\"elementsregion0=\",\"descriptionregion0=\"]\nlistMapEn=[\"region0name=\",\"region0color=\",\"region0items=\",\"region0description=\"]\n\nRegSFr=[\"(.*)\\[\\[(Image|Fichier):(.*)\\s*$\",\"(=+)(.*)(=+)(.*)\",\"(.*){{(Listing|Faire|Voir|Acheter|Manger|Boire|Sortir|Se loger|Destination|Aller|Circuler)\\s(.*)\\s*$\",\"(.*)}}[.\\s]*$\",\"{{Dans\\|(.*)}}\\s*$\"]\nRegSFr.extend([\"^(=+)(.*) \u00e0 (.*)(=+)\\s*$\",\"(.*){{ListeRegions(.*)\",\"(.*)region([0-9]+)=(.*)\",\"{{Avancement\\|statut=(\u00e9bauche|esquisse|utilisable|guide|\u00e9toile)\\|type=0}}(.*)\",\"(.*){{Climat(.*)\",\"(.*){{Repr\u00e9sentation diplomatique\"])\nRegSEn=[\"(.*)\\[\\[(Image|File):(.*)\\s*$\", \"(=+)(.*)(=+)(.*)\",\"(.*){{(listing|do|see|buy|eat|drink|sleep)\\s(.*)\\s*$\",\"(.*)}}[.\\s]*$\",\"{{IsPartOf\\|(.*)}}\\s*$\"]\nRegSEn.extend([\"^(=+)(.*) to (.*)(=+)\\s*$\",\"(.*){{Regionlist(.*)\",\"(.*)region(.*)name=(.*)\",\"{{(outline|usable|guide|stub|star)0}}(.*)\",\"(.*){{Climate(.*)\",\"(.*){{flag|(.*)}}(.*){{Listing(.*)\"])\n\navFr=\"{{Avancement|statut=esquisse|type=0}}\\n\" \navEn=\"{{outline0}}\\n\"\n\nlistMoisFr=[\"jan\",\"fev\",\"mar\",\"avr\",\"mai\",\"jui\",\"jul\",\"aou\",\"sep\",\"oct\",\"nov\",\"dec\"]\nlistMoisEn=[\"jan\",\"feb\",\"mar\",\"apr\",\"may\",\"jun\",\"jul\",\"aug\",\"sep\",\"oct\",\"nov\",\"dec\"]\n\nlistClimatFr=[\"Climat\",\"description\"]\nlistClimatEn=[\"Climate\",\"description\"]\nfor mois in listMoisFr :\n\tlistClimatFr.append(\"tmin-\"+mois)\n\tlistClimatFr.append(\"tmax-\"+mois)\n\tlistClimatFr.append(\"prec-\"+mois)\nfor mois in listMoisEn :\n\tlistClimatEn.append(mois+\"low\")\n\tlistClimatEn.append(mois+\"high\")\n\tlistClimatEn.append(mois+\"precip\")\n\n\nListFr=(listTypeFr,listSectionFr,listImageFr,listListingDebFr,listListingFr,listItineraireFr,listDansFr,listMapDebFr,listMapFr,RegSFr,avFr,listClimatFr)\nListEn=(listTypeEn,listSectionEn,listImageEn,listListingDebEn,listListingEn,listItineraireEn,listDansEn,listMapDebEn,listMapEn,RegSEn,avEn,listClimatEn)\n\nListingsSpecialFr={\"Villes\":\"Ville\",\"Autres destinations\":\"Destinations\",\"Aux environs\":\"Destinations\"}\nListLang ={\"fr\":ListFr, \"en\":ListEn}\n\n\nsrc=ListEn\ndest=ListFr\nlang=\"en\"\ncontent=\"\"\nsection=\"\"\ndef recupTypeArticle() :\n\treturn\n\ttypeArticle = dest[0][0]\n\tlistRegex = list()\n\tfor mot in src[0] :\n\t\ts=src[9][8].replace(\"0\",mot)\n\t\tlistRegex.append(re.compile(s))\n\n\tbOk=True\n\tfor line in content:\n\t\tif (not bOk) :\n\t\t\tbreak\n\t\tfor i in range (len(listRegex)) :\n\t\t\tif listRegex[i].search(line) :\n\t\t\t\ttypeArticle=dest[0][i]\n\t\t\t\tbOk=False\n\t\t\t\tbreak\n\treturn typeArticle\n\t\ndef creationEntete (typeArticle,titre) :\n\ts=\"\"\n\tif dest==ListFr : #\u00a0Si on traduit en fran\u00e7ais\n\t\ts=\"\"\"{{Banni\u00e8re page}}\n{{Info \"\"\"+typeArticle+\"\"\"\n| nom=\n| nom local=\n| r\u00e9gion=\n| image=\n| l\u00e9gende image=\n| rivi\u00e8re=\n| superficie=\n| population=\n| population agglom\u00e9ration=\n| ann\u00e9e population= \n| altitude=\n| latitude=\n| longitude=\n| zoom=\n| code postal=\n| indicatif=\n| adresse OT=\n| horaire OT=\n| t\u00e9l\u00e9phone OT=\n| num\u00e9ro gratuit OT=\n| email OT=\n| facebook OT=\n| twitter OT=\n| URL OT=\n| URL officiel=\n| URL touristique=\n}}\n\"\"\"\n\treturn s\ndef recupImage(line) :\n\ts=line\n\tfor i in range (len(src[2])) :\n\t\ts=s.replace(src[2][i],dest[2][i])\n\treturn s\ndef recupSection(line) :\n\ts=line\n\tfor i in range (len(src[1])) :\n\t\ts=s.replace(src[1][i],dest[1][i])\n\treturn s\ndef recupListing(line,debut)\t:\n\ts=line\n\tif debut :\n\t\tfor i in range (len(src[3])) :\n\t\t\ts=s.replace(src[3][i],dest[3][i])\n\t\t\t\t\t\t\n\tfor i in range (len(src[4])) :\n\t\ts=s.replace(src[4][i],dest[4][i])\n\treturn s\n\t\ndef recupItineraire(line) :\n\ts=line\n\tfor i in range (len(src[5])) :\n\t\t\ts=s.replace(src[5][i],dest[5][i])\n\treturn s\n\ndef recupDans(line) :\n\ts=line\n\tfor i in range (len(src[6])) :\n\t\t\ts=s.replace(src[6][i],dest[6][i])\n\treturn s\n\ndef recupMap(line,numMap) :\n\ts=line\n\tif numMap == 0 :\n\t\tfor i in range (len(src[7])) :\n\t\t\t\ts=s.replace(src[7][i],dest[7][i])\n\tnumPrec=str(numMap-1)\n\tsNumMap=str(numMap)\n\tfor i in range (len(src[8])):\n\t\tsrc[8][i]=src[8][i].replace(numPrec,sNumMap)\n\t\tdest[8][i]=dest[8][i].replace(numPrec,sNumMap)\n\tif numMap > 0 :\n\t\tfor i in range (len(src[8])) :\n\t\t\ts=s.replace(src[8][i],dest[8][i])\n\treturn s\ndef recupClimat(line) :\n\ts=line\n\tfor i in range (len(src[11])):\n\t\ts=s.replace(src[11][i],dest[11][i])\n\treturn s\n\n\nparser = argparse.ArgumentParser()\nparser.add_argument('title',help=\"nom de la page \u00e0 convertir\" )\nparser.add_argument('--src',help=\"langage source : fr,en,\u2026 par d\u00e9fault fr \")\nparser.add_argument('--dest',help=\"langage destination : fr,en,\u2026 par d\u00e9fault en \")\nparser.add_argument('-d','--debug',action='store_true' ,help=\"mode debugage : r\u00e9cup\u00e9ration du fichier source en m\u00eame temps que le r\u00e9sultat\")\nparser.add_argument('-C','--nocomment',action='store_true' ,help=\"commentaires d\u00e9sactiv\u00e9 dans le r\u00e9sultat \")\n\nargs = parser.parse_args()\nbAv=False # Pour savoir si la banni\u00e8re d'avancement \u00e0 \u00e9t\u00e9 plac\u00e9\nresult=\"\" # Pou stock\u00e9 le resultat\ntitle=args.title\nif args.src and args.src.lower() in ListLang.keys() :\n\tsrc=ListLang[args.src.lower()]\n\tlang=args.src.lower()\nif args.dest and args.dest.lower() in ListLang.keys() :\n\tdest=ListLang[args.dest.lower()]\n\t\nurl=\"https://\"+lang+\".wikivoyage.org/w/index.php?title=\"+title+\"&action=raw\"\ncontent=urllib.urlopen(url).readlines()\nTypeArticle=recupTypeArticle()\nresult        +=creationEntete(TypeArticle,title)\nregImg        =re.compile(src[9][0])\nregSection    =re.compile(src[9][1])\nregListing    =re.compile(src[9][2])\nregListingEnd =re.compile(src[9][3])\nregDans       =re.compile(src[9][4])\nregItineraire =re.compile(src[9][5])\nregMap        =re.compile(src[9][6])\nregNomRegion  =re.compile(src[9][7])\nregClimat     =re.compile(src[9][9])\nregDiplomat   =re.compile(src[9][10])\ni=0\nnumMap=-1\nbClimat=False\nbListing=False\nfor line in content:\n\ti=i+1\n\tif numMap>-1 :\n\t\tif regNomRegion.search(line) :\n\t\t\tnumMap=numMap+1\n\t\tresult+=recupMap(line,numMap)\n\t\tif regListingEnd.search(line) :\n\t\t\tsNumMap=str(numMap)\n\t\t\tfor i in range (len(src[8])):\n\t\t\t\tsrc[8][i]=src[8][i].replace(sNumMap,\"0\")\n\t\t\t\tdest[8][i]=dest[8][i].replace(sNumMap,\"0\")\n\t\t\tnumMap=-1\n\tif bClimat or regClimat.search(line):\n\t\tresult+=recupClimat(line)\n\t\tbClimat=True\n\t\tif regListingEnd.search(line) :\n\t\t\tbClimat=False\n\telif bListing :\n\t\ts=recupListing(line,False)\n\t\tif regListingEnd.search(line) :\t\t\t\t\t\n\t\t\tbListing=False\n\t\t\tif not regListingEnd.search(s) :\n\t\t\t\ts+=\"}}\"\n\t\tresult+=s\n\telif regDiplomat.search(line) and dest==ListFr :\n\t\ts=\"* {{Repr\u00e9sentation diplomatique\"\n\t\tbListing=True\n\t\tresult+=s\n\telif regMap.search(line) :\n\t\tnumMap=0\n\t\tresult+=recupMap(line,numMap)\n\telif regItineraire.search(line) :\n\t\tresult+=recupItineraire(line)\n\telif regListing.search(line) :\n\t\ts=recupListing(line,True)\n\t\tif dest==ListFr and section in ListingsSpecialFr.keys() :\n\t\t\ts=s.replace('Listing',ListingsSpecialFr[section])\n\t\tresult+=s\n\t\tbListing=True\n\telif regImg.search(line) :\n\t\tresult+=recupImage(line)\n\telif regSection.search(line) :\n\t\ts=recupSection(line)\n\t\tif len(s)>3 and s[2] !=\"=\" :\n\t\t\tsection=s.replace(\"==\",\"\").replace(\"\\n\",\"\")\n\t\tresult+=s\n\telif regDans.search(line) :\n\t\ts=dest[10].replace(\"0\",TypeArticle.lower()) #avancement\n\t\tresult+=s\n\t\tbAv=True\n\t\tresult+=recupDans(line)\nif (not bAv) : # Si la banni\u00e8re avancement n'a toujour pas \u00e9t\u00e9 plac\u00e9\n\ts=dest[10].replace(\"0\",TypeArticle.lower())\n\tresult+=s\ntitle=title.replace(\"/\",\"-\")\ntitle=title.replace(\".\",\"-\")\nif args.nocomment is True :\n\tresult=re.sub(r'<!--(.*)(.|\\n)(.*)-->',r'\\2',result)\nwith open(\"./\"+title+\".txt\", \"w\") as fichier:\n\tfichier.write(result)\nif args.debug is True :\n\twith open(\"./\"+title+\"_src.txt\", \"w\") as fichier:\n\t\tfichier.writelines(content)\n",
  "line_no": 91,
  "line_no_percent": "31%"
}