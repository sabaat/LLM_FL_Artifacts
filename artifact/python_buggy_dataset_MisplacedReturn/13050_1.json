{
  "instruction": "This code is a Python program that scrapes the ESPN FC website for content. To run the program, you need to import the necessary libraries, set the output path for Windows or Mac environments, and define the team URLs. The program will then parse the team news for each team URL and output the results to a text file. To download images, use the downloadImage function.",
  "buggy_code": "'''\nCreated on Jan 30, 2015\nModified on Jan 30, 2015\n@author: rainier.madruga@gmail.com\nA simple Python Program to scrape the ESPN FC website for content.\n'''\n'''\nVersion Number of Script\n'''\nversion = '0.01.a'\n\nfrom bs4 import BeautifulSoup\nimport urllib2\nimport datetime\nimport requests\nimport os\nimport platform\nimport sys\nreload(sys)\nsys.setdefaultencoding('utf-8')\n\nts = datetime.datetime.now().strftime(\"%H:%M:%S\")\nds = datetime.datetime.now().strftime(\"%Y-%m-%d\")\ndate = datetime.datetime.now().strftime(\"%Y%m%d\")\n\ndef updateTS():\n    return\n    update = datetime.datetime.now().strftime(\"%H:%M:%S\")\n    return update\n\ndef downloadImage(imageURL, localFileName):\n    response = requests.get(imageURL)\n    if response.status_code == 200:\n        print 'Downloading %s...' % (localFileName)\n    with open(localFileName, 'wb') as fo:\n        for chunk in response.iter_content(4096):\n            fo.write(chunk)\n    return True\n\nparseVersion = 'ESPN Premier League Team News ' + version\nprint ds + ' :: ' + ts + ' :: ' + parseVersion\n\nos_System = platform.system()\nwin_BasePath = \"C:/Users/Rainier/Documents/GitHub/python-soccer\"\n\nif os_System == \"Windows\":\n    outputPath = win_BasePath + \"/PL-Data/\"\n    outputImgPath = win_BasePath + \"/PL-Data/imgs/\"\n    outputTeamPath = win_BasePath + \"/PL-Data/teams/\"\n    outputMatchPath = win_BasePath + \"/PL-Data/match/\"\nelse:\n    outputPath = 'PL-Data/'\n    outputImgPath = 'PL-Data/imgs/'\n    outputTeamPath = 'PL-Data/teams/'\n    outputMatchPath = 'PL-Data/match/'\n\nhr = \" >>> *** ====================================================== *** <<<\"\nshr = \" >>> *** ==================== *** <<<\"\n\nprefixBBC = \"http://www.bbc.com\"\nprefixESPN = \"http://www.espnfc.us\"\n\nteamURLs = ['/club/arsenal/359/index','/club/aston-villa/362/index','/club/burnley/379/index','/club/chelsea/363/index','/club/crystal-palace/384/index','/club/everton/368/index','/club/hull-city/306/index','/club/leicester-city/375/index','/club/liverpool/364/index','/club/manchester-city/382/index','/club/manchester-united/360/index','/club/newcastle-united/361/index','/club/queens-park-rangers/334/index','/club/southampton/376/index','/club/stoke-city/336/index','/club/sunderland/366/index','/club/swansea-city/318/index','/club/tottenham-hotspur/367/index','/club/west-bromwich-albion/383/index','/club/west-ham-united/371/index']\n\ndef teamNews(x):\n\tteamURL = x\n\tteamName = x\n\tteamName = teamName[6:len(teamName)-10]\n\tteamURL = prefixESPN + teamURL\n\tteamHTML = urllib2.urlopen(teamURL)\n\tteamSoup = BeautifulSoup(teamHTML)\t\n\trecentNews = teamSoup.find(\"div\", {\"id\":\"feed\"})\n\trecentNewsItems = recentNews.find_all(\"div\", {\"class\":\"feed-item-content\"})\n\trecapOutput = []\n\tprint \"Team News Parsed :: \" + teamName\n\tfor i in recentNewsItems:\n\t\trecapPhotoItem = i.find(\"div\", {\"class\":\"thumbnail picture\"})\n\n\t\tif len(i) > 3:\n\t\t\trecapHeadline = i.find(\"h2\")\n\t\t\trecapHeadlineDetails = recapHeadline.find(\"a\")\n\t\t\trecapHeadlineDetails = recapHeadlineDetails[\"href\"]\n\t\t\trecapHeadline = recapHeadline.get_text(strip=True)\n\t\t\trecapAge = i.find(\"span\", {\"class\":\"age\"})\n\t\t\trecapAge = recapAge.get_text(strip=True)\n\t\t\trecapOutput.append(date + \"|\" + teamName + \"|\" + recapHeadline + \"|\" + recapHeadlineDetails + \"|\" + recapAge)\n\t\t\t\n\t\telse:\n\t\t\trecapGameOpponents = i.find_all(\"div\", {\"class\":\"team-name\"})\n\t\t\trecapGameScore = i.find_all(\"div\", {\"class\":\"team-score\"})\n\t\t\trecapGameStatus = i.find(\"div\", {\"class\":\"game-info\"})\n\t\t\trecapGameHome = recapGameOpponents[0].get_text(strip=True)\n\t\t\trecapGameAway = recapGameOpponents[1].get_text(strip=True)\n\t\t\trecapHomeScore = recapGameScore[0].get_text(strip=True)\n\t\t\trecapAwayScore = recapGameScore[1].get_text(strip=True)\n\t\t\trecapOutput.append(date + \"|\" + teamName + \"|\" + recapGameHome + \" \" + recapHomeScore +  \" v. \" + recapAwayScore + \" \"+ recapGameAway + \"||\")\n\tfor i in recapOutput:\n\t\tprint i\n\tprint hr \n\treturn recapOutput\n\nteamNewstxt = 'teamNews.txt'\nwith open(teamNewstxt, \"w\") as f:\n   \tf.write(ds + \" :: \" + updateTS() + \" :: \" + parseVersion + '\\n' )\n   \tf.close()\n\nfor i in teamURLs:\n\tfor x in teamNews(i):\n\t\twith open(teamNewstxt, \"a\") as f:\n\t\t\tf.write(x + '\\n')\n\t\t\tf.close()\n",
  "line_no": 27,
  "line_no_percent": "24%"
}