{
  "instruction": "Design a full stack application for user authentication in Python.",
  "buggy_code": "import flask\nfrom flask import Flask, request, redirect, render_template\nfrom flask_login import LoginManager, login_user, login_required\nimport os\nimport sqlite3\n\napp = Flask(__name__)\napp.secret_key = os.urandom(24)\n\ndb_file = './data.db'\nconn = sqlite3.connect(db_file)\ncursor = conn.cursor()\n\nlogin_manager = LoginManager()\nlogin_manager.init_app(app)\n\n@login_manager.user_loader\ndef load_user(user_id):\n    cursor.execute(f\"SELECT * FROM users WHERE id = {user_id}\")\n    user = cursor.fetchone()\n    return User(*user)\n\n@app.route('/login', methods=['GET', 'POST'])\ndef login():\n    if request.method == 'GET':\n        return render_template('login.html')\n    elif request.method == 'POST':\n        username = request.form['username']\n        password = request.form['password']\n        \n        cursor.execute(f\"SELECT * FROM users WHERE username = ?\" , (username,))\n        user = cursor.fetchone()\n        if user is not None and check_password_hash(user[3], password):\n            login_user(User(*user))\n            return redirect(url_for('index'))\n        else:\n            return redirect(url_for('login'))\n            \n@app.route('/')\n@login_required\ndef index():\n    return\n    return 'Welcome to the application!'\n\nif __name__ == '__main__':\n    app.run()\n",
  "line_no": 42,
  "line_no_percent": "91%"
}