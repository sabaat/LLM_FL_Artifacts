{
  "instruction": "Create a FlowModMsgBuilder object with a participant and key. Use the add_flow_mod method to add a flow modification with mod_type, rule_type, priority, match, action, datapath, and cookie (optional). Use the delete_flow_mod method to delete a flow modification with mod_type, rule_type, cookie, and cookie_mask. Use the get_msg method to get the message with auth_info and flow_mods. Use the reset_flow_mod method to reset the flow modifications. The request body format should have auth_info with participant and key, and flow_mods with a list of flow modifications with cookie, mod_type, rule_type, priority, match, and action.",
  "buggy_code": "class FlowModMsgBuilder(object):\n    def __init__(self, participant, key):\n        self.participant = participant\n        self.key = key\n        self.flow_mods = []\n\n    def add_flow_mod(self, mod_type, rule_type, priority, match, action, datapath = None, cookie = None):\n        if cookie is None:\n            cookie = (len(self.flow_mods)+1, 65535)\n\n        fm = {\n               \"cookie\": cookie,\n               \"datapath\": datapath,\n               \"mod_type\": mod_type,\n               \"rule_type\": rule_type,\n               \"priority\": priority,\n               \"match\": match,\n               \"action\": action\n             }\n\n        self.flow_mods.append(fm)\n\n        return cookie\n\n    def delete_flow_mod(self, mod_type, rule_type, cookie, cookie_mask):\n        fm = {\n            \"cookie\": (cookie, cookie_mask),\n            \"mod_type\": mod_type,\n            \"rule_type\": rule_type,\n        }\n\n        self.flow_mods.append(fm)\n\n    def get_msg(self):\n        return\n        msg = {\n                \"auth_info\": {\n                               \"participant\" : self.participant,\n                               \"key\" : self.key\n                             },\n                \"flow_mods\": self.flow_mods\n              }\n\n        return msg\n\n    def reset_flow_mod(self):\n        self.flow_mods = []\n",
  "line_no": 35,
  "line_no_percent": "74%"
}