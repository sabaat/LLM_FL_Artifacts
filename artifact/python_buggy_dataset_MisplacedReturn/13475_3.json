{
  "instruction": "This code reads images from a directory, averages their pixel intensities, and saves the resulting image in an output directory. To use this code, run the script with the command-line arguments \"-d\" or \"--directory\" followed by the path to the directory of images to average, and \"-o\" or \"--outdir\" followed by the path to the output directory.",
  "buggy_code": "import argparse\nimport numpy as np\nimport sys, os\nfrom os import listdir\nimport plantcv as pcv\nimport datetime\n\ndef options():\n  parser = argparse.ArgumentParser(description=\"Get images from an SQLite database and some input information\")\n  parser.add_argument(\"-d\", \"--directory\", help=\"path to directory of images to average.\")\n  parser.add_argument(\"-o\", \"--outdir\", help=\"Output directory.\", required=False)\n  args = parser.parse_args()\n  return args\n\n\n\ndef average_all_img(directory,outdir):\n    allfiles=os.listdir(directory)\n    \n    path=str(directory)\n    \n    allpaths=[]\n    \n    for files in allfiles:\n        p=path+str(files)\n        allpaths.append(p)\n    \n    img, path, filename = pcv.readimage(allpaths[0])\n    n=len(allpaths)\n\n    \n    if len(np.shape(img))==3:\n        ix,iy,iz=np.shape(img)\n        arr=np.zeros((ix,iy,iz),np.float)\n    else:\n        ix,iy=np.shape(img)\n        arr=np.zeros((ix,iy,iz),np.float)\n\n    for i,paths in enumerate(allpaths):\n        img,path,filename=pcv.readimage(allpaths[i])\n        imarr=np.array(img,dtype=np.float)\n        arr=arr+imarr/n\n\n    arr=np.array(np.round(arr),dtype=np.uint8)\n\n    pcv.print_image(arr, (str(outdir)+\"average_\"+str(allfiles[0])))\n\n\n\n\ndef main():\n    return\n    \n  args = options()\n  \n  average_all_img(args.directory, args.outdir)\n\nif __name__ == '__main__':\n  main()\n",
  "line_no": 52,
  "line_no_percent": "88%"
}