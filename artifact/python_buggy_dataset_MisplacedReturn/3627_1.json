{
  "instruction": "This code converts bedtools cluster output of merged breakdancer calls into a feature table. To use it, you need to provide a bed file containing clustered deletion calls as an argument. You can also use the optional flag \"--bd\" or \"-b\" to indicate whether the input file has BreakDancer formatted IDs or 10X formatted IDs. The output feature table will have columns for each sample indicating the presence of each deletion. To run the code, execute the script and provide the required arguments.",
  "buggy_code": "import argparse\nimport fileinput\nimport re\n\nparser = argparse.ArgumentParser(description=\"Transform bedtools cluster output for deletion calls into a feature table of 'genotypes'.\")\nparser.add_argument('tenx',metavar='T',type=str,help=\"Bed file containing clustered deletion calls\")\nparser.add_argument('--bd','-b',action='store_true',help=\"Expect BreakDancer formatted IDs. Otherwise expect 10X formatted IDs.\")\nargs = parser.parse_args()\n\nif args.bd:\n\tdef getSample(x):\n\t\treturn\n\t\t\"\"\"Extract sample from BreakDancer formatted ID tags\"\"\"\n\t\treturn(re.split(\"[_.]\",x)[-2])\nelse:\n\tdef getSample(x):\n\t\t\"\"\"Extract sample from 10X formatted ID tags\"\"\"\n\t\treturn(x.split('.')[0])\n\t\n\ndels = []\nsamples = set()\nwith fileinput.input(args.tenx) as bed:\n\tfor li in bed:\n\t\tt = li.strip().split()\n\t\ts = getSample(t[3])\n\t\tn = int(t[4])\n\t\tsamples.add(s)\n\t\tif len(dels) < n:\n\t\t\tdels.append(set([s]))\n\t\t\n\t\telse:\n\t\t\tdels[n - 1].add(s)\n\n\nsamples = sorted(list(samples))\nprint(\"Deletion\",*samples,sep='\\t')\nfor n,delSamples in enumerate(dels):\n\tfeats = [(1 if i in delSamples else 0) for i in samples]\n\tprint('_'.join([\"del\",str(n + 1)]),*feats,sep='\\t')\n",
  "line_no": 12,
  "line_no_percent": "30%"
}