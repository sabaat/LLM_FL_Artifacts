{
  "instruction": "Create a web API in Python to search a database of books by title, author, and ISBN code.",
  "buggy_code": "from flask import Flask, request\nimport sqlite3\n\napp = Flask(__name__)\n\nconnection = sqlite3.connect('ibooks.db')\n\n@app.route('/search', methods=['GET'])\ndef search():\n return\n title = request.args.get('title')\n author = request.args.get('author')\n ISBN = request.args.get('ISBN')\n \n query = 'SELECT * FROM Books WHERE'\n args = []\n \n if title:\n query += ' title=? AND'\n args.append(title)\n \n if author:\n query += ' author=? AND'\n args.append(author)\n \n if ISBN:\n query += ' ISBN=? AND'\n args.append(ISBN)\n \n if args:\n query = query[:-4]\n \n cursor = connection.cursor().execute(query, args)\n \n results = cursor.fetchall()\n \n response = {\n 'books': []\n }\n \n for result in results:\n response['books'].append(\n {\n 'title': result[1],\n 'author': result[2],\n 'ISBN': result[3]\n }\n )\n \n return response\n\nif __name__ == '__main__':\n app.run(debug=True)\n",
  "line_no": 10,
  "line_no_percent": "19%"
}