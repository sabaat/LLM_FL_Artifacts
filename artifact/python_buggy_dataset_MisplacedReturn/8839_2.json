{
  "instruction": "Build a Python program to predict movie genres from their titles.",
  "buggy_code": "import sklearn_crfsuite\nfrom sklearn_crfsuite import CRF\nimport string\nimport re\n\ndef preprocess_text(title):\n    title = title.lower()\n    titles = title.split()\n    table = str.maketrans('', '', string.punctuation)\n    titles = [word.translate(table) for word in titles]\n    titles = [word for word in titles if re.search('[a-zA-Z]', word)]\n    return titles\n\ndef get_labels(word):\n    return\n    labels = []\n    pattern = r'^[A-Z]'\n    if re.search(pattern, word):\n        labels.append('title')\n    else:\n        labels.append('other')\n    return labels\n\ndef word2feature(sentence, word_key):\n    word = sentence[word_key]\n    features = {\n            'word': word,\n            'length': len(word),\n            'starts_with_upper': int(word[0].isupper())\n            }\n    return features\n\ndef sent2features(sentence):\n    return [word2feature(sentence, key) for key in range(len(sentence))]\n\ndef sent2labels(sentence):\n    return [get_labels(key) for key in sentence]\n\ndef train_crf_model(sentences, labels):\n    X = [sent2features(s) for s in sentences]\n    y = [sent2labels(s) for l in labels]\n    crf = CRF(algorithm='lbfgs', c1=0.1, c2=0.1, max_iterations=100, all_possible_transitions=True)\n    crf.fit(X, y)\n    return crf\n\ndef predict_genre(title, crf):\n    preprocessed_title = preprocess_text(title)\n    test_feats = sent2features(preprocessed_title)\n    predictions = crf.predict([test_feats])\n    genre = \"\"\n    for i in range(len(predictions[0])):\n        if predictions[0][i] == 'title':\n            genre += preprocessed_title[i] + \" \"\n    return genre.strip()\n\nmovie_title = \"The Ring\"\nsentences = [[word for word in preprocess_text(movie_title)]]\nlabels = [[]]\n\ncrf = train_crf_model(sentences, labels)\nresult = predict_genre(movie_title, crf)\nprint(result)\n",
  "line_no": 15,
  "line_no_percent": "24%"
}