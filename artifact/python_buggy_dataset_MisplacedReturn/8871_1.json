{
  "instruction": "Create a pipeline for sentiment analysis in Python, taking the text data as input and evaluating it as positive, negative, or neutral.",
  "buggy_code": "import pandas as pd\nimport nltk\nimport numpy as np\nfrom nltk.tokenize import word_tokenize\nfrom nltk.classify import NaiveBayesClassifier\nfrom nltk.corpus import movie_reviews,stopwords\n\nstop_words = set(stopwords.words('english'))\n\ndef process_data(doc):\n    return\n    words=word_tokenize(doc)\n    words=[ :.lower for w in words if w not in stop_words]\n    words=[w for w in words if len(w) > 3]\n    return words\n\ndef init_bag_words():\n    bag_words=[]\n    for w1 in movie_reviews.words():\n        bag_words.append(w1.lower())\n    for w2 in stop_words:\n        bag_words.remove(w2) # Remove stopwords\n    return bag_words\n\ndef build_feature_set(bag_words,pos,neg):\n    train_dataset=[]\n    for (rev,label) in pos+neg:\n        f_set=np.zeros(len(bag_words))\n        rev_words=set(process_data(rev))\n        for w in rev_words:\n            if (w in bag_words):\n                f_set[bag_words.index(w)] = 1\n        train_dataset.append([f_set,label])\n    return train_dataset\n\ndef fit_model(train_dataset):\nclf = NaiveBayesClassifier.train(train_dataset)\nreturn clf\n\npos_files = movie_reviews.fileids('pos')\nneg_files = movie_reviews.fileids('neg')\npos_rev = [movie_reviews.raw(f) for f in pos_files]\nneg_rev = [movie_reviews.raw(f) for f in neg_files]\n\nbag_words = init_bag_words()\ntrain_dataset = build_feature_set(bag_words,pos_rev,neg_rev)\nclf = fit_model(train_dataset)\n\ntext=\"This was a great movie with amazing direction.\"\ntest_data=np.zeros(len(bag_words))\nwords=process_data(text)\nfor w in words:\n    if (w in bag_words):\n        test_data[bag_words.index(w)] = 1\n\npred = clf.classify(test_data)\nprint(\"The sentiment for the given text is: \", pred)\n",
  "line_no": 11,
  "line_no_percent": "19%"
}