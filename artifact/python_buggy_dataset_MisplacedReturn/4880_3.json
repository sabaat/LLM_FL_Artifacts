{
  "instruction": "Create a Python Flask application with an API backend. The application should allow users to search and rate movies. The API should have endpoints for movie search, movie rating and reviews retrieval.",
  "buggy_code": "from flask import Flask, request\nimport requests\n\napp = Flask(__name__)\n\n@app.route('/movie/search', methods=['GET'])\ndef search_movie():\n   query = request.args.get('query')\n   api_key = '<YOUR_API_KEY>'\n   url = 'http://www.omdbapi.com/?apikey={}&s={}'.format(api_key, query)\n\nresponse = requests.get(url).json()\n\nmovies = []\nfor movie in response['Search']:\n   movies.append({\n   'title': movie['Title'],\n   'id': movie['imdbID'],\n   'year': movie['Year'],\n   'poster': movie['Poster'],\n   })\n\nreturn {\n 'movies': movies\n}\n\n@app.route('/movie/<movie_id>/rating', methods=['GET'])\ndef get_movie_rating(movie_id):\n    url = 'http://www.omdbapi.com/?apikey={}&i={}'.format(api_key, movie_id)\n    response = requests.get(url).json()\n    return {\n        'rating': response['imdbRating']\n    }\n\n@app.route('/movie/<movie_id>/reviews', methods=['GET'])\ndef get_movie_reviews(movie_id):\n    return\n    url = 'http://www.omdbapi.com/?apikey={}&i={}'.format(api_key, movie_id)\n    response = requests.get(url).json() \n    reviews = []\n    for review in response['Ratings']:\n        reviews.append({ \n            'source': review['Source'],\n            'score': review['Value'],\n        })\n    return {\n        'reviews': reviews\n    }\n\nif __name__ == '__main__':\n\tapp.run(debug=True)\n",
  "line_no": 37,
  "line_no_percent": "73%"
}