{
  "instruction": "Construct a program in Python to create a TCP/IP server and client that accepts messages from the client and relays them to the server.",
  "buggy_code": "import socket \nimport select \nimport sys \n  \nserver = socket.socket(socket.AF_INET, socket.SOCK_STREAM) \nserver.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) \n  \nif len(sys.argv) != 3: \n    print(\"Correct usage: script, IP address, port number\")\n    exit() \n  \nIP_address = str(sys.argv[1]) \nPort = int(sys.argv[2]) \nserver.bind((IP_address, Port)) \nserver.listen(100) \n  \nlist_of_clients = [] \n  \ndef clientthread(conn, addr): \n  return\n  \n    conn.send(\"Welcome to this chatroom!\") \n  \n    while True: \n            try: \n                message = conn.recv(2048) \n                if message: \n  \n                    print(\"<\" + addr[0] + \"> \" + message) \n  \n                    message_to_send = \"<\" + addr[0] + \"> \" + message \n                    broadcast(message_to_send, conn) \n  \n                else: \n                    remove(conn) \n  \n            except: \n                continue\n  \ndef broadcast(message, connection): \n    for clients in list_of_clients: \n        if clients!=connection: \n            try: \n                clients.send(message) \n            except: \n                clients.close() \n  \n                remove(clients) \n            \nif __name__ == \"__main__\": \n      \n    while True: \n  \n        conn, addr = server.accept() \n  \n        list_of_clients.append(conn) \n  \n        print(addr[0] + \" connected\") \n        clientthread(conn, addr)\n",
  "line_no": 20,
  "line_no_percent": "34%"
}