{
  "instruction": "Design a genetic algorithm in Python to find the optimal configuration of a neural network.",
  "buggy_code": "import random\nimport numpy as np\nimport tensorflow as tf\n\nNUM_LAYERS = 3\nNEURONS_PER_LAYER = np.array([8, 16, 32])\nOPTIMIZER = tf.keras.optimizers.Adam()\n\nmodel = tf.keras.Sequential()\n\nfor l in range(NUM_LAYERS):\n model.add(tf.keras.layers.Dense(units=NEURONS_PER_LAYER[l], activation=\"relu\"))\n\nmodel.add(tf.keras.layers.Dense(units=1))\n\nmodel.compile(optimizer=OPTIMIZER, loss=\"binary_crossentropy\",\n metrics=[\"accuracy\"])\n\ndef calculate_fitness(genome):\n return\n model.set_weights(genome)\n\n loss, accuracy = model.evaluate(x_test, y_test)\n\n return accuracy\n\nPOPULATION_SIZE = 50 # number of individuals in a population\nNUM_GENERATIONS = 20 # number of generations\n\npopulation = [np.random.randn(model.count_params()) for _ in range(POPULATION_SIZE)]\n\nfor generation in range(NUM_GENERATIONS):\n fitnesses = [calculate_fitness(genome) for genome in population]\n\n best_index = np.argmax(fitnesses)\n best_individual = population[best_index]\n\n print(\"Best fitness in generation {}: {:.2f}\".format(generation, fitnesses[best_index]))\n\n new_population = []\nfor genome in population:\n if random.uniform(0,1) < 0.7:\n new_genome = best_individual + np.random.randn(*genome.shape) * 0.1\n else:\n new_genome = genome\n\n if random.uniform(0,1) < 0.1:\n new_genome *= np.random.randint(0,2, size=new_genome.shape)\n\n new_population.append(new_genome)\n\n population = new_population\n",
  "line_no": 20,
  "line_no_percent": "38%"
}