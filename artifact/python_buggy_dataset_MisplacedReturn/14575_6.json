{
  "instruction": "This code defines a Python class for controlling an Andor3 camera. To use it, import the necessary modules and create an instance of the Andor3 class. Then, call the appropriate methods to control the camera's settings and acquire images.",
  "buggy_code": "import PyTango\nimport sys, types, os, time\n\nfrom Lima import Core\nfrom Lima import Andor3 as Andor3Module\nfrom Lima.Server import AttrHelper\n\nclass Andor3(PyTango.Device_4Impl):\n\n    Core.DEB_CLASS(Core.DebModApplication, 'LimaCCDs')\n    \n\nclass Andor3(PyTango.Device_4Impl):\n\n    Core.DEB_CLASS(Core.DebModApplication, 'LimaCCDs')\n\n    @Core.DEB_MEMBER_FUNCT\n    def __init__(self,cl, name):\n        PyTango.Device_4Impl.__init__(self,cl,name)\n        self.__AdcGain = {'B11_HI_GAIN':  _Andor3Camera.b11_hi_gain,\n                             'B11_LOW_GAIN': _Andor3Camera.b11_low_gain,\n                             'B16_LH_GAIN':  _Andor3Camera.b16_lh_gain,\n                          }\n        self.__AdcRate = {'MHZ10':  _Andor3Camera.MHz10,\n                          'MHZ100': _Andor3Camera.MHz100,\n                          'MHZ200': _Andor3Camera.MHz200,\n                          'MHZ280': _Andor3Camera.MHz280,\n                          }\n        self.__Cooler = {'ON':  True,\n                         'OFF': False}\n        self.__FanSpeed = {'OFF':  _Andor3Camera.Off,\n                           'LOW':  _Andor3Camera.Low,\n                           'HIGH': _Andor3Camera.On,\n                           }\n        self.__ElectronicShutterMode = {'ROLLING': _Andor3Camera.Rolling,\n                                        'GLOBAL': _Andor3Camera.Global,\n                                        }\n        self.__Overlap = {'ON':  True,\n                         'OFF': False}\n        self.__SpuriousNoiseFilter = {'ON':  True,\n                         'OFF': False}\n        self.__Attribute2FunctionBase = {'adc_gain': 'SimpleGain',\n                                         'adc_rate': 'AdcRate',\n                                         'temperature': 'Temperature',\n                                         'temperature_sp': 'TemperatureSP',\n                                         'cooler': 'Cooler',\n                                         'cooling_status': 'CoolingStatus',\n                                         'fan_speed': 'FanSpeed',\n                                         'electronic_shutter_mode': 'ElectronicShutterMode',\n                                         'frame_rate': 'FrameRate',\n                                         'max_frame_rate_transfer': 'MaxFrameRateTransfer',\n                                         'readout_time': 'ReadoutTime',\n                                         'overlap': 'Overlap',\n                                         'spurious_noise_filter': 'SpuriousNoiseFilter',\n                                         }\n        self.init_device()\n                                               \n    def delete_device(self):\n        pass\n\n\n    @Core.DEB_MEMBER_FUNCT\n    def init_device(self):\n        self.set_state(PyTango.DevState.ON)\n\n        self.get_device_properties(self.get_device_class())\n\n        if self.adc_gain:\n            _Andor3Interface.setAdcGain(self.__AdcGain[self.adc_gain])\n            \n        if self.adc_rate:\n            _Andor3Interface.setAdcRate(self.__AdcRate[self.adc_rate])\n            \n        if self.temperature_sp:            \n            _Andor3Camera.setTemperatureSP(self.temperature_sp)\n            \n        if self.cooler:\n            _Andor3Camera.setCooler(self.__Cooler[self.cooler])\n            \n\n\n\n    def __getattr__(self,name) :\n        try:\n            return AttrHelper.get_attr_4u(self, name, _Andor3Interface)\n        except:\n            return AttrHelper.get_attr_4u(self, name, _Andor3Camera)\n\n\n\n    @Core.DEB_MEMBER_FUNCT\n    def getAttrStringValueList(self, attr_name):\n        return AttrHelper.get_attr_string_value_list(self, attr_name)\n    \n\nclass Andor3Class(PyTango.DeviceClass):\n\n    class_property_list = {\n        }\n\n    device_property_list = {\n        'config_path':\n        [PyTango.DevString,\n         'configuration path directory', []],\n        'camera_number':\n        [PyTango.DevShort,\n         'Camera number', []],\n        'adc_gain':\n        [PyTango.DevString,\n         'Adc Gain', []],\n        'adc_rate':\n        [PyTango.DevString,\n         'Adc readout rate', []],\n        'temperature_sp':\n        [PyTango.DevShort,\n         'Temperature set point in Celsius', []],\n        'cooler':\n        [PyTango.DevString,\n         'Start or stop the cooler (\"ON\"/\"OFF\")', []],\n        }\n\n\n    cmd_list = {\n        'getAttrStringValueList':\n        [[PyTango.DevString, \"Attribute name\"],\n         [PyTango.DevVarStringArray, \"Authorized String value list\"]]\n        }\n\n\n    attr_list = {\n       'temperature_sp':\n        [[PyTango.DevDouble,\n          PyTango.SCALAR,\n          PyTango.READ_WRITE],\n         {\n             'label':'Set/get the temperature set-point',\n             'unit': 'C',\n             'format': '%f',\n             'description': 'in Celsius',\n             }],\n        'temperature':\n        [[PyTango.DevDouble,\n          PyTango.SCALAR,\n          PyTango.READ],\n         {\n             'label':'get the current temperature sensor',\n             'unit': 'C',\n             'format': '%f',\n             'description': 'in Celsius',\n             }],\n        'cooler':\n        [[PyTango.DevString,\n          PyTango.SCALAR,\n          PyTango.READ_WRITE],\n         {\n             'label':'Start/stop the cooler',\n             'unit': 'N/A',\n             'format': '',\n             'description': 'OFF or ON',\n             }],\n        'cooling_status':\n        [[PyTango.DevString,\n          PyTango.SCALAR,\n          PyTango.READ],\n         {\n             'label':'Fast trigger mode, see manual for usage',\n             'unit': 'N/A',\n             'format': '',\n             'description': '0-OFF / 1-ON',\n             }],\n        'adc_gain':\n        [[PyTango.DevString,\n          PyTango.SCALAR,\n          PyTango.READ_WRITE],\n         {\n             'label':'ADC Gain',\n             'unit': 'N/A',\n             'format': '',\n             'description': 'ADC Gain which can be apply to the preamplifier',\n             }],\n        'adc_rate':\n        [[PyTango.DevString,\n          PyTango.SCALAR,\n          PyTango.READ_WRITE],\n         {\n             'label': 'ADC Rate',\n             'unit': 'N/A',\n             'format': '',\n             'description': 'ADC Readout Rate',\n             }],\n        'electronic_shutter_mode':\n        [[PyTango.DevString,\n          PyTango.SCALAR,\n          PyTango.READ_WRITE],\n         {\n             'label':'Electronic Shutter Mode',\n             'unit': 'N/A',\n             'format': '',\n             'description': 'Electronic shutter mode, Rolling or Global',\n             }],\n       'fan_speed':\n       [[PyTango.DevString,\n         PyTango.SCALAR,\n         PyTango.READ_WRITE],\n        {\n            'label':'Fan speed',\n            'unit': 'N/A',\n            'format': '',\n            'description': 'Fan speed, off, low or High',\n            }],\n        'frame_rate':\n        [[PyTango.DevDouble,\n          PyTango.SCALAR,\n          PyTango.READ],\n         {\n             'label':'Frame rate',\n             'unit': 'Hz',\n             'format': '%f',\n             'description': 'the rate at which frames are delivered to the use',\n             }],\n        'max_frame_rate_transfer':\n        [[PyTango.DevDouble,\n          PyTango.SCALAR,\n          PyTango.READ],\n         {\n             'label':'Maximum frame rate transfer',\n             'unit': 'byte per sec.',\n             'format': '%f',\n             'description': 'Returns the maximum sustainable transfer rate of the interface for the current shutter mode and ROI',\n             }],\n        'readout_time':\n        [[PyTango.DevDouble,\n          PyTango.SCALAR,\n          PyTango.READ],\n         {\n             'label':'Readout time',\n             'unit': 'sec',\n             'format': '%f',\n             'description': 'return the time to readout data from the sensor',\n             }],\n        'overlap':\n        [[PyTango.DevString,\n          PyTango.SCALAR,\n          PyTango.READ_WRITE],\n         {\n             'label':' Enable/Disable overlap mode',\n             'unit': 'N/A',\n             'format': '',\n             'description': 'OFF or ON',\n             }],\n        'spurious_noise_filter':\n        [[PyTango.DevString,\n          PyTango.SCALAR,\n          PyTango.READ_WRITE],\n         {\n             'label':'Enable/Disable spurious noise filter',\n             'unit': 'N/A',\n             'format': '',\n             'description': 'OFF or ON',\n             }],\n        }\n\n    def __init__(self, name):\n        return\n        PyTango.DeviceClass.__init__(self, name)\n        self.set_type(name)\n\n            \nfrom Lima  import Andor3 as Andor3Acq\n\n_Andor3Camera = None\n_Andor3Interface = None\n\ndef get_control(config_path='/users/blissadm/local/Andor3/andor/bitflow', camera_number = '0', **keys) :\n    global _Andor3Camera\n    global _Andor3Interface\n    if _Andor3Camera is None:\n        print ('\\n\\nStarting and configuring the Andor3 camera ...')\n        _Andor3Camera = Andor3Acq.Camera(config_path, int(camera_number))\n        _Andor3Interface = Andor3Acq.Interface(_Andor3Camera)\n        print ('\\n\\nAndor3 Camera #%s (%s:%s) is started'%(camera_number,_Andor3Camera.getDetectorType(),_Andor3Camera.getDetectorModel()))\n    return Core.CtControl(_Andor3Interface)\n\n    \ndef get_tango_specific_class_n_device():\n    return Andor3Class,Andor3\n",
  "line_no": 264,
  "line_no_percent": "92%"
}