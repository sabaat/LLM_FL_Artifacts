{
  "instruction": "The given code is a Python script that converts National Water Model output data to GSSHA formatted input. To use this script, you need to create an instance of the NWMtoGSSHA class and provide the necessary input parameters such as the path to the GSSHA project folder, the name of the GSSHA elevation grid file, the path to the input folder for the LSM files, and the search pattern for LSM files. Once you have created an instance of the class, you can use its methods to convert LSM data to GSSHA format. For example, you can use the `lsm_precip_to_gssha_precip_gage` method to convert LSM precipitation data to GSSHA precipitation gage data. You can also use the `lsm_data_to_arc_ascii` method to convert LSM data to GSSHA arc ascii format.",
  "buggy_code": "import logging\nfrom datetime import timedelta\nfrom os import mkdir, path, remove, rename\nimport xarray as xr\n\nfrom .grid_to_gssha import GRIDtoGSSHA\n\nlog = logging.getLogger(__name__)\n\n\nclass NWMtoGSSHA(GRIDtoGSSHA):\n    \"\"\"This class converts the National Water Model output data to GSSHA formatted input.\n    This class inherits from class:`GRIDtoGSSHA`.\n\n    Attributes:\n        gssha_project_folder(:obj:`str`): Path to the GSSHA project folder\n        gssha_project_file_name(:obj:`str`): Name of the GSSHA elevation grid file.\n        lsm_input_folder_path(:obj:`str`): Path to the input folder for the LSM files.\n        lsm_search_card(:obj:`str`): Glob search pattern for LSM files. Ex. \"*.grib2\".\n        lsm_lat_var(Optional[:obj:`str`]): Name of the latitude variable in the LSM netCDF files. Defaults to 'lat'.\n        lsm_lon_var(Optional[:obj:`str`]): Name of the longitude variable in the LSM netCDF files. Defaults to 'lon'.\n        lsm_time_var(Optional[:obj:`str`]): Name of the time variable in the LSM netCDF files. Defaults to 'time'.\n        lsm_lat_dim(Optional[:obj:`str`]): Name of the latitude dimension in the LSM netCDF files. Defaults to 'lat'.\n        lsm_lon_dim(Optional[:obj:`str`]): Name of the longitude dimension in the LSM netCDF files. Defaults to 'lon'.\n        lsm_time_dim(Optional[:obj:`str`]): Name of the time dimension in the LSM netCDF files. Defaults to 'time'.\n        output_timezone(Optional[:obj:`tzinfo`]): This is the timezone to output the dates for the data. Default is he GSSHA model timezone. This option does NOT currently work for NetCDF output.\n\n    Example::\n\n\n        from datetime import datetime\n        from gsshapy.grid import NWMtoGSSHA\n\n        n2g = NWMtoGSSHA(gssha_project_folder='E:\\\\GSSHA',\n                         gssha_project_file_name='gssha.prj',\n                         lsm_input_folder_path='E:\\\\GSSHA\\\\nwm-data',\n                         lsm_search_card=\"*.grib\")\n\n        out_gage_file = 'E:\\\\GSSHA\\\\nwm_rain1.gag'\n        n2g.lsm_precip_to_gssha_precip_gage(out_gage_file,\n                                            lsm_data_var=\"RAINRATE\",\n                                            precip_type=\"RADAR\")\n\n        data_var_map_array = [\n            ['precipitation_rate', 'RAINRATE'],\n            ['pressure', 'PSFC'],\n            ['relative_humidity', ['Q2D','T2D', 'PSFC']],\n            ['wind_speed', ['U2D', 'V2D']],\n            ['direct_radiation', 'SWDOWN'],  # ???\n            ['diffusive_radiation', 'SWDOWN'],  # ???\n            ['temperature', 'T2D'],\n            ['cloud_cover', '????'],\n        ]   \n        e2g.lsm_data_to_arc_ascii(data_var_map_array)\n\n    \"\"\"\n    def __init__(self,\n                 gssha_project_folder,\n                 gssha_project_file_name,\n                 lsm_input_folder_path,\n                 lsm_search_card=\"*.nc\",\n                 lsm_lat_var='y',\n                 lsm_lon_var='x',\n                 lsm_time_var='time',\n                 lsm_lat_dim='y',\n                 lsm_lon_dim='x',\n                 lsm_time_dim='time',\n                 output_timezone=None,\n                 ):\n        \"\"\"\n        Initializer function for the NWMtoGSSHA class\n        \"\"\"\n        super(NWMtoGSSHA, self).__init__(gssha_project_folder,\n                                         gssha_project_file_name,\n                                         lsm_input_folder_path,\n                                         lsm_search_card,\n                                         lsm_lat_var,\n                                         lsm_lon_var,\n                                         lsm_time_var,\n                                         lsm_lat_dim,\n                                         lsm_lon_dim,\n                                         lsm_time_dim,\n                                         output_timezone)\n\n    @property\n    def xd(self):\n        \"\"\"get xarray dataset file handle to LSM files\"\"\"\n        if self._xd is None:\n            path_to_lsm_files = path.join(self.lsm_input_folder_path,\n                                          self.lsm_search_card)\n            self._xd = super(NWMtoGSSHA, self).xd\n            self._xd.lsm.coords_projected = True\n        return self._xd\n\n    def _load_converted_gssha_data_from_lsm(self, gssha_var, lsm_var, load_type):\n        return\n        \"\"\"\n        This function loads data from LSM and converts to GSSHA format\n        \"\"\"\n        super(NWMtoGSSHA, self).\\\n            _load_converted_gssha_data_from_lsm(gssha_var, lsm_var, load_type)\n        self.data.lsm.coords_projected = True\n",
  "line_no": 96,
  "line_no_percent": "94%"
}