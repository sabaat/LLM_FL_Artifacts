{
  "instruction": "This code defines two classes: Button and PopUp. Button creates a button sprite with text and an optional background image. PopUp creates a popup window with text, images, and a button. The type of popup window can be customized with different parameters. To use these classes, create instances of Button and PopUp with the desired parameters and add them to a sprite group. To handle events, call the manejador_eventos method of the PopUp instance and check the return value for a click on the button.",
  "buggy_code": "import pygame\nfrom .texto import texto\nfrom .textoci import texto2\nfrom .imgfondo import fondo\nTEXT_COLOR2 = (0, 0, 0)\nCOLOR_RED = (213, 0, 0)\nBAR_COLOR = (151, 0, 172)\nTEXT_COLOR = (255, 255, 255)\n\nclass Button(pygame.sprite.Sprite):\n\n    def __init__(self, identificador, parent, text, fondo=0, ancho=500):\n        \"\"\"\n        M\u00e9todo inicializador de la clase. \n        \n        @param identificador: Variable usada para identificar al bot\u00f3n.\n        @type identificador: str\n        @param parent: Instancia del gestor de pantallas.\n        @type parent: Manejador\n        @param text: Variable que indica el texto que tendr\u00e1 el bot\u00f3n.\n        @type text: str\n        @param fondo: Indica si el fondo del bot\u00f3n sera con imagen o sin imagen (en desarrollo).\n        @type fondo: bool\n        @param ancho: Indica el ancho del bot\u00f3n. Es usado para cuadrar el texto centrado.\n        @type ancho: int\n        \"\"\"\n        pygame.sprite.Sprite.__init__(self)\n        self.ancho = ancho\n        self.parent = parent\n        tipografia = pygame.font.match_font('FreeSans', False, False)\n        font = pygame.font.Font(tipografia, parent.config.t_fuente)\n        self.identificador = identificador\n        varios = '../imagenes/png/varios/'\n        if fondo == 0:\n            texto1 = font.render(text, 1, TEXT_COLOR)\n            textorect = texto1.get_rect()\n            texto2 = font.render(text, 1, COLOR_RED)\n            self.img_fondo = pygame.image.load(varios + 'img-boton.png')\n            self.img_fondo2 = pygame.image.load(varios + 'img-boton.png')\n            imgrect = self.img_fondo.get_rect()\n            textorect.center = (imgrect.center[0], imgrect.center[1] + imgrect.center[1] / 3)\n            self.img_fondo.blit(texto1, textorect)\n            self.img_fondo2.blit(texto2, textorect)\n            self.rect = self.img_fondo.get_rect()\n            self.image = self.img_fondo\n        if fondo == 1:\n            txt = texto(0, 0, text, parent.config.t_fuente, 'texto_act', self.ancho)\n            self.rect = pygame.Rect(0, 0, self.ancho, txt.ancho_final)\n            image_texto = pygame.Surface((self.ancho, txt.ancho_final))\n            image_texto.fill((255, 255, 255))\n            image_texto.set_colorkey((255, 255, 255))\n            for i in txt.img_palabras:\n                image_texto.blit(i.image, i.rect)\n            self.image = image_texto\n            self.img_fondo = image_texto\n            self.img_fondo2 = image_texto\n\n    def cambiar_status(self, status):\n        \"\"\"\n        Dibuja un efecto en los botones cambiando la imagen de fondo (descontinuado)\n        \"\"\"\n        if status:\n            self.image = self.img_fondo2\n        else:\n            self.image = self.img_fondo\n\n    def mover_boton(self, x, y):\n        \"\"\"\n        Cambia la posici\u00f3n del bot\u00f3n.\n        \"\"\"\n        self.rect.center = (x, y)\n\nclass PopUp(pygame.sprite.Sprite):\n\n    def __init__(self, parent, texto1, palabra_boton, imagenes, grupo, tipo=0, px=512, py=281, tam=0):\n        \"\"\"\n        M\u00e9todo inicializador de la clase. \n                \n        @param parent: Instancia del gestor de pantallas.\n        @type parent: Manejador\n        @param texto1: Indica el texto que ser\u00e1 mostrado en la ventana emergente.\n        @type texto1: str \n        @param palabra_boton: Indica la palabra que tendr\u00e1 el bot\u00f3n. Solo es usado en caso de ser tipo = 0,\n        de ser distinto de 0 toma el valor de una cadena y no ser\u00e1 asignado.\n        @type palabra_boton: str\n        @param imagenes: Indica la(s) imagen(es) que mostrar\u00e1 la ventana emergente. En caso de tipo = 2\n        no es un campo necesario, en caso de tipo = 1 debe ser una superficie y en caso de tipo = 0\n        el par\u00e1metro debe ser una tupla con dos im\u00e1genes, la  posici\u00f3n 0 sera la imagen\n        que estar\u00e1 al lado del texto, mientras que la posici\u00f3n 1 sera la imagen que estar\u00e1 debajo del texto.\n        @type imagenes: pygame.Surface, tuple\n        @param grupo: Representa un grupo de Sprites donde ser\u00e1 agregado el sprite con la imagen y su rect\u00e1ngulo.\n        @type grupo: pygame.sprite.Group\n        @param tipo: Determina el tipo de ventana emergente, si toma el valor de 2 la ventana emergente solo\n        tomara el par\u00e1metro texto1 (los dem\u00e1s par\u00e1metros deben ser introducidos), en caso de tomar el valor 1\n        la ventana emergente tomara los par\u00e1metros texto1, imagenes y palabra_boton, mostrando una ventana\n        ordenada con texto justificado, un espacio a derecha donde sera ubicada la imagen (dicha imagen debe \n        tener m\u00e1ximo 1/3 del tama\u00f1o de la ventana emergente) y un bot\u00f3n centrado debajo del texto. En caso de\n        tomar valor 0 la ventana emergente sera similar a la anterior, con la diferencia que tendr\u00e1 una imagen\n        m\u00e1s ubicada en la parte izquierda del bot\u00f3n y debajo del texto.\n        @type tipo: int\n        \"\"\"\n        pygame.sprite.Sprite.__init__(self)\n        self.parent = parent\n        self.sprite = pygame.sprite.Sprite()\n        varios = '../imagenes/png/varios/'\n        self.texto = pygame.Surface\n        self.tipo = tipo\n        self.arreglo_botones = []\n        self.grupo = grupo\n        self.click = -1\n        self.activo = 0\n        self.tam = 0\n        if tipo == 0:\n            self.img_fondo = pygame.image.load(varios + 'cuadropop-up.png').convert_alpha()\n            self.sprite.image = pygame.image.load(varios + 'cuadropop-up.png').convert_alpha()\n            self.sprite.rect = self.sprite.image.get_rect()\n            x = 30\n            y = 30\n            self.texto = texto(x, y, texto1[0], parent.config.t_fuente, 'texto_act', self.sprite.rect.width * 2 / 3)\n            self.area_texto = pygame.Rect(x, y, self.sprite.rect.w * 2 / 3, self.texto.ancho_final)\n            self.area_imagenes = pygame.Rect(self.sprite.rect.w * 2 / 3 + 80, y, self.sprite.rect.w / 3, self.texto.ancho_final)\n            self.parent = parent\n            self.boton = Button(0, self.parent, palabra_boton)\n            self.boton.mover_boton(self.sprite.rect.width / 2, self.area_texto.h + (x - 2) + self.boton.rect.h / 2)\n            self.boton_rect = pygame.Rect(self.boton.rect.x, self.boton.rect.y, self.boton.rect.width, self.boton.rect.height)\n            self.sprite.image = fondo(self.sprite.rect.w, self.boton.rect.y + self.boton.rect.h + x, 5).return_imagen()\n            self.imagen = pygame.sprite.Sprite()\n            if type(imagenes) != pygame.Surface:\n                self.imagen2 = pygame.sprite.Sprite()\n                self.imagen.image = imagenes[0]\n                self.imagen.rect = self.imagen.image.get_rect()\n                self.imagen.rect.center = (self.sprite.rect.w * 2 / 3 + self.sprite.rect.w / 3 / 2, self.area_imagenes.h / 2 + self.boton_rect.h / 2)\n                self.imagen2.image = imagenes[1]\n                self.imagen2.rect = self.imagen.image.get_rect()\n                self.imagen2.rect.left = x\n                self.imagen2.rect.y = self.area_texto.h + 40\n                self.sprite.image.blit(self.imagen2.image, self.imagen2.rect)\n            else:\n                self.imagen.image = imagenes\n                self.imagen.rect = self.imagen.image.get_rect()\n                self.imagen.rect.center = (self.sprite.rect.w * 2 / 3 + self.sprite.rect.w / 3 / 2, self.area_imagenes.h / 2 + self.boton_rect.h / 2)\n            if self.imagen.rect.y < 5:\n                self.imagen.rect.y = 6\n            for i in self.texto.img_palabras:\n                self.sprite.image.blit(i.image, i.rect)\n            self.sprite.image.blit(self.boton.image, self.boton.rect)\n            self.sprite.image.blit(self.imagen.image, self.imagen.rect)\n            self.sprite.rect.center = (px, py)\n            self.boton_rect.center = (self.sprite.rect.x + self.sprite.rect.width / 2, self.sprite.rect.y + self.area_texto.h + x * 2 + self.boton.rect.h / 2)\n        if tipo == 1:\n            self.img_fondo = pygame.image.load(varios + 'cuadropop-up.png').convert_alpha()\n            self.sprite.image = pygame.image.load(varios + 'cuadropop-up.png').convert_alpha()\n            self.sprite.rect = self.sprite.image.get_rect()\n            x = 15\n            y = 15\n            o = 0\n            separacion = 30\n            tabulacion = 30\n            self.sprite.rect.w += tam\n            for i in texto1:\n                if o == 0:\n                    self.texto = texto(x, y, i, parent.config.t_fuente, 'texto_act', self.sprite.rect.width - x)\n                if o > 0:\n                    self.arreglo_botones.append(Button(o - 1, self.parent, i, 1, self.sprite.rect.w - x * 2 - tabulacion))\n                o += 1\n            self.texto.rect = pygame.Rect(x, y, self.sprite.rect.w - 80, self.texto.ancho_final)\n            y += self.texto.ancho_final + separacion\n            for i in self.arreglo_botones:\n                i.rect.x = x + tabulacion / 2\n                i.rect.y = y\n                y += i.rect.h + separacion / 2\n            self.img_fondo = fondo(self.sprite.rect.w, y).return_imagen()\n            self.sprite.image = fondo(self.sprite.rect.w, y).return_imagen()\n            for i in self.texto.img_palabras:\n                self.sprite.image.blit(i.image, i.rect)\n                self.img_fondo.blit(i.image, i.rect)\n            self.sprite.rect.center = (px, py)\n            for i in self.arreglo_botones:\n                self.sprite.image.blit(i.image, i.rect)\n                self.img_fondo.blit(i.image, i.rect)\n                i.rect.x = self.sprite.rect.x + i.rect.x\n                i.rect.y = self.sprite.rect.y + i.rect.y\n        if tipo == 2:\n            self.sprite.image = pygame.image.load(varios + 'cuadropop-up.png').convert_alpha()\n            self.sprite.rect = self.sprite.image.get_rect()\n            self.sprite.rect.w += tam\n            self.texto = texto2(15, 15, texto1, parent.config.t_fuente, 'intercalado', self.sprite.rect.w - 15, imagenes)\n            self.sprite.image = fondo(self.sprite.rect.w, self.texto.ancho_final + 30).return_imagen()\n            self.sprite.rect.h = self.texto.ancho_final + 30\n            self.tam = self.texto.ancho_final + 60\n            for i in self.texto.img_palabras:\n                self.sprite.image.blit(i.image, i.rect)\n            self.sprite.rect.center = (px, py)\n\n    def popup_estatus(self):\n        \"\"\"\n        Define cuando esta activa la ventana emergente.\n    \n        @return: En caso de ser True la ventana esta activa, en caso contrario no estar\u00e1 activa.\n        @rtype: bool\n        \"\"\"\n        if self.activo:\n            return True\n        else:\n            return False\n\n    def redibujar_boton(self):\n        \"\"\"\n        Define el efecto de los botones en las ventanas emergentes (descontinuado)\n        \"\"\"\n        if self.tipo == 0:\n            self.sprite.image.blit(self.img_fondo, (self.boton.rect.x, self.boton.rect.y), self.boton.rect)\n            self.sprite.image.blit(self.boton.img, self.boton.rect)\n        if self.tipo == 1:\n            self.sprite.image.blit(self.img_fondo, (0, 0))\n\n    def agregar_grupo(self):\n        \"\"\"\n        Agrega el sprite de la ventana emergente al grupo de sprite pasado por par\u00e1metros al crear el objeto.\n        \"\"\"\n        self.activo = 1\n        self.grupo.add(self.sprite)\n\n    def eliminar_grupo(self):\n        \"\"\"\n        Elimina el sprite de la ventana emergente del grupo de sprite pasado por par\u00e1metros al crear el objeto.\n        \"\"\"\n        self.activo = 0\n        self.grupo.remove(self.sprite)\n\n    def evaluar_click(self):\n        \"\"\"\n        Retorna el resultado del m\u00e9todo manejador_eventos().\n    \n        @return: True si se hizo click, de lo contrario False.\n        @rtype: bool\n        \"\"\"\n        return self.click\n\n    def manejador_eventos(self, eventos):\n        \"\"\"\n        Determina cuando se hace click al bot\u00f3n\n        (solo en caso de ser una ventana emergente de tipo 0 o 1)\n    \n        @param eventos: Ultimo evento recibido.\n        @rtype: pygame.event.Event\n        \"\"\"\n        teclasPulsadas = pygame.key.get_pressed()\n        if self.tipo == 0:\n            if self.boton_rect.collidepoint(pygame.mouse.get_pos()):\n                if eventos.type == pygame.MOUSEBUTTONDOWN and eventos.button == 1:\n                    self.eliminar_grupo()\n                    self.click = 0\n                    return True\n                else:\n                    self.click = -1\n            if teclasPulsadas[pygame.K_RETURN]:\n                self.eliminar_grupo()\n                self.click = 0\n            else:\n                self.click = -1\n        if self.tipo == 1:\n            for i in self.arreglo_botones:\n                if i.rect.collidepoint(pygame.mouse.get_pos()):\n                    if eventos.type == pygame.MOUSEBUTTONDOWN and eventos.button == 1:\n                        self.click = i.identificador\n                    else:\n                        self.click = -1",
  "line_no": 125,
  "line_no_percent": "47%"
}