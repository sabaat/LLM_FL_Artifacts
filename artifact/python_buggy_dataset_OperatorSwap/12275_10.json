{
  "instruction": "The code is a Python script that checks for the latest episode of Bigg Boss 8 on colors.in.com. To use the script, run it from the command line with optional arguments for a custom search pattern or verbose output. The script will send a request to the server, get the page data as a string, and search for the latest episode link and episode list based on a pattern. If a new episode is found, the script will notify the user and print the link. Otherwise, it will print \"No new episode right now\". The script is free software under the GNU General Public License.",
  "buggy_code": "import os\nimport os.path\nimport platform\nimport random\nimport re\nimport sys\nimport time\nif sys.version_info >= (3,):\n    import urllib.request as urllib2\n    import urllib.parse as urlparse\n    import urllib.error as urlerror\nelse:\n    import urllib2\n    import urlparse\n\ndef atoi(text):\n    return int(text) if text.isdigit() else text\n\ndef natural_keys(text):\n    \"\"\"\n    alist.sort(key=natural_keys) sorts in human order\n    http://nedbatchelder.com/blog/200712/human_sorting.html\n    (See Toothy's implementation in the comments)\n    \"\"\"\n    return [atoi(c) for c in re.split('(\\\\d+)', text)]\n\ndef notify_user(message=None):\n    \"\"\" Notify the user about a particular event with given message\n    \"\"\"\n    if not message:\n        message = 'Notification!!!'\n    print('-' * int((len(message) - 6) / 2), 'NOTIFICATION', '-' * int((len(message) + 6) / 2))\n    print(message)\n\ndef get_page_data():\n    \"\"\" Get page data as string from server\n    \"\"\"\n    print('Sending request to servers of Colors . . .')\n    full_url = 'http://colors.in.com/in/biggboss'\n    full_url = 'http://colors.in.com/in/biggboss/videos/episodes'\n    try:\n        response = urllib2.urlopen(full_url)\n    except urlerror.HTTPError as exep:\n        print(\"The server couldn't fulfill the request.\", 'Error code: ', exep.code)\n    except urlerror.URLError as exep:\n        print('We failed to reach a server.')\n        print('Reason: ', exep.reason)\n    else:\n        print('Data received, Decoding . . .')\n        web_page = str(response.read())\n        return web_page\n\ndef get_link(web_page):\n    \"\"\" Get Latest episode link\n    \"\"\"\n    month = time.strftime('%B')\n    new_link_pattern = 'http://colors.in.com/in/biggboss/videos/bigg-boss-8-full-episode\\\\d\\\\d-' + month.lower() + '-\\\\d+\\\\w\\\\w-2014.*?.html'\n    link_reg = re.findall(new_link_pattern, web_page)\n    if link_reg:\n        success_set = sorted(set(link_reg), key=natural_keys)\n        return success_set[-1]\n\ndef get_episode_list(web_page, new_episode_pattern=None):\n    \"\"\" Get latest episode list from webpage\n    \"\"\"\n    if not new_episode_pattern:\n        new_episode_pattern = time.strftime('%B-\\\\d+\\\\w\\\\w').lower()\n        month = time.strftime('%B')\n        new_episode_pattern = 'Bigg Boss \\\\d+, Full Episode-\\\\d+, ' + month + ' \\\\d+\\\\w\\\\w, 2014'\n    print('Checking for new episode with pattern:', new_episode_pattern)\n    success = re.findall(new_episode_pattern, web_page)\n    success_set = sorted(set(success), key=natural_keys)\n    return success_set\n\ndef check_biggboss_episode(new_episode_pattern=None, verbose=False):\n    \"\"\" Check for the latest bigg boss episode\n    \"\"\"\n    web_page = get_page_data()\n    if verbose:\n        print('Page Received:\\n', web_page)\n    success_set = get_episode_list(web_page, new_episode_pattern)\n    print('Found:')\n    for item in success_set:\n        print('\\t', item)\n    current_date = int(time.strftime('%d'))\n    current_hour = int(time.strftime('%H'))\n    current_month = time.strftime('%B')\n    if current_month.lower() in success_set[-1].lower() and (str(current_date) in success_set[-1] and current_hour >= 20 or (str(current_date - 1) in success_set[-1] and (current_hour >= 0 and current_hour < 20))):\n        msg = 'Found new episode online'\n        notify_user(msg)\n        latest_link = get_link(web_page)\n        if latest_link:\n            print(\"Here's the link: \", latest_link)\n    else:\n        print('No new episode right now')\n\ndef main():\n    \"\"\" Main function - Parse command line arguments\n    \"\"\"\n    from argparse import ArgumentParser\n    parser = ArgumentParser(prog='BiggBoss-checker')\n    parser.add_argument('-p', '--pattern', type=str, dest='pattern', help='Search for this pattern instead of default')\n    parser.add_argument('-v', '--verbose', dest='verbosity', action='store_true', default=False, help='Show verbose output')\n    args = parser.parse_args()\n    try:\n        check_biggboss_episode(args.pattern, verbose=args.verbosity)\n    except:\n        raise\n    return 0\nif __name__ == '__main__':\n    try:\n        main()\n        if os.name == 'nt' or platform.system() == 'Windows':\n            input('Press Enter or Close the window to exit !')\n    except KeyboardInterrupt:\n        print('\\nClosing garacefully :)', sys.exc_info()[1])\n    except urlerror.HTTPError:\n        print('HTTP Error:', sys.exc_info()[1])\n    except SystemExit:\n        pass\n    except:\n        print('Unexpected Error:', sys.exc_info()[0])\n        print('Details:', sys.exc_info()[1])\n        raise",
  "line_no": 34,
  "line_no_percent": "27%"
}