{
  "instruction": "To reproduce Figure 8 from Prsa et al. 2016, first set up a binary system with reasonable albedos and relevant parameters. Then compute light curves with wilson and horvat irradiation and plot the relative differences between the two as a function of phase, for several different values of the inclination. Use the given code as a reference.",
  "buggy_code": "get_ipython().system('pip install -I \"phoebe>=2.0,<2.1\"')\nget_ipython().run_line_magic('matplotlib', 'inline')\nimport phoebe\nfrom phoebe import u\nimport numpy as np\nimport matplotlib.pyplot as plt\nlogger = phoebe.logger('error')\nb = phoebe.default_binary()\nprint(b['irrad_method'])\nb['teff@primary'] = 11000\nb['rpole@primary'] = 2.5\nb['gravb_bol@primary'] = 1.0\nb['teff@secondary'] = 5000\nb['rpole@secondary'] = 0.85\nb['q@binary'] = 0.8 / 3.0\nb.flip_constraint('mass@primary', solve_for='sma@binary')\nb['mass@primary'] = 3.0\nprint(b.filter(qualifier=['mass', 'rpole', 'teff'], context='component'))\nb['irrad_frac_refl_bol@primary'] = 1.0\nb['irrad_frac_refl_bol@secondary'] = 0.6\nphases = np.linspace(0, 1, 101)\nb.add_dataset('lc', times=b.to_time(phases))\nfor incl in [0, 30, 60, 90]:\n    b.set_value('incl@binary', incl)\n    b.run_compute(irrad_method='wilson')\n    fluxes_wilson = b.get_value('fluxes', context='model')\n    b.run_compute(irrad_method='horvat')\n    fluxes_horvat = b.get_value('fluxes', context='model')\n    plt.plot(phases, fluxes_wilson / fluxes_horvat / fluxes_wilson, label='i={}'.format(incl))\nplt.xlabel('phase')\nplt.ylabel('[F(wilson) - F(horvat)] / F(wilson)')\nplt.legend(loc='upper center')\nplt.show()",
  "line_no": 71,
  "line_no_percent": "215%"
}