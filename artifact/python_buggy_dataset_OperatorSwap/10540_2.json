{
  "instruction": "Create an open-ended RNN generation program that can generate a novel from a given set of sentences. The program should be built in Python using the Keras or Tensorflow library.",
  "buggy_code": "import tensorflow as tf\nimport numpy as np\nfrom tensorflow.keras.preprocessing.text import Tokenizer\nfrom tensorflow.keras.preprocessing.sequence import pad_sequences\nsentences = ['Snow was steadily falling, blanketing the ground in white.', 'A gentle wind was blowing in from the nearby mountains.', 'The sky was a foggy grey, with no sign of the sun.']\ntokenizer = Tokenizer(filters='!\"#$%&()*+.,-/:;<=>?@[\\\\]^_`{|}~\\t\\n')\ntokenizer.fit_on_texts(sentences)\ninput_seq = tokenizer.texts_to_sequences(sentences)\nmaxlen = max([len(x) for x in input_seq])\ninput_seq = pad_sequences(input_seq, maxlen=maxlen, padding='post')\nbatch_size = len(input_seq)\ninputs = tf.keras.Input(shape=(maxlen,))\nx = tf.keras.layers.Embedding(input_dim=len(tokenizer.word_index) + 1, output_dim=128)(inputs)\nx = tf.keras.layers.LSTM(128)(x)\nx = tf.keras.layers.Dense(128, activation='relu')(x)\nx = tf.keras.layers.Dense(len(tokenizer.word_index) - 1, activation='softmax')(x)\nmodel = tf.keras.Model(inputs=inputs, outputs=x)\nmodel.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])\nmodel.fit(input_seq, epochs=30, batch_size=batch_size)\nseed_text = 'The'\nnext_words = 100\nfor _ in range(next_words):\n    token_list = tokenizer.texts_to_sequences([seed_text])[0]\n    token_list = pad_sequences([token_list], maxlen=maxlen, padding='post')\n    predicted = np.argmax(model.predict(token_list), axis=-1)\n    output_word = ''\n    for word, index in tokenizer.word_index.items():\n        if index == predicted:\n            output_word = word\n            break\n    seed_text += ' ' + output_word\nprint(seed_text)",
  "line_no": 30,
  "line_no_percent": "94%"
}