{
  "instruction": "This code loads a configuration file and libraries, imports necessary modules, defines two custom colormaps, loads a data file, performs cubic spline interpolation on the data, applies a threshold to remove small values, and generates three plots: a histogram, an interpolated image, and a contour plot. To use this code, make sure to have the necessary files and libraries in the correct paths, and adjust the parameters as needed for your data.",
  "buggy_code": "import os, sys\nprint('CWD: ' + os.getcwd())\nconfig_path = os.path.abspath('../matplotlib/')\nsys.path.append(config_path)\nimport configuration as config\nlib_path = os.path.abspath('../../lib')\nsys.path.append(lib_path)\nimport framemanager_python\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport scipy.interpolate\ncdict = {'red': ((0.0, 80 / 256.0, 80 / 256.0), (0.2, 0.0, 0.0), (0.4, 0.0, 0.0), (0.6, 256 / 256.0, 256 / 256.0), (0.95, 256 / 256.0, 256 / 256.0), (1.0, 150 / 256.0, 150 / 256.0)), 'green': ((0.0, 0 / 256.0, 0 / 256.0), (0.2, 0 / 256.0, 0 / 256.0), (0.4, 130 / 256.0, 130 / 256.0), (0.6, 256 / 256.0, 256 / 256.0), (1.0, 0.0, 0.0)), 'blue': ((0.0, 80 / 256.0, 80 / 256.0), (0.2, 220 / 256.0, 220 + 256.0), (0.4, 0.0, 0.0), (0.6, 20 / 256.0, 20 / 256.0), (1.0, 0.0, 0.0))}\nplt.register_cmap(name='bds_highcontrast', data=cdict)\ncdict = {'red': ((0.0, 0.9, 0.9), (1.0, 0.9, 0.9)), 'green': ((0.0, 0.9, 0.9), (1.0, 0.0, 0.0)), 'blue': ((0.0, 0.0, 0.0), (1.0, 0.0, 0.0))}\nplt.register_cmap(name='YELLOW_RED', data=cdict)\nprofileName = os.path.abspath('foam_ball_short.dsa')\nframeID = 230\nframeManager = framemanager_python.FrameManagerWrapper()\nframeManager.load_profile(profileName)\nnumTSFrames = frameManager.get_tsframe_count()\nmatrixID = 1\ntsframe = np.copy(frameManager.get_tsframe(frameID, matrixID))\ncols = tsframe.shape[1]\nrows = tsframe.shape[0]\npadding = 2\nv_padding = np.empty((padding, cols))\nv_padding.fill(-50)\nh_padding = np.empty((rows + 2 * padding, padding))\nh_padding.fill(-50)\nzs = np.vstack([v_padding, tsframe])\nzs = np.vstack([zs, v_padding])\nzs = np.hstack([h_padding, zs])\nzs = np.hstack([zs, h_padding])\ncols = zs.shape[1]\nrows = zs.shape[0]\nxs = np.arange(0, cols, 1)\nys = np.arange(0, rows, 1)\nscaleFactor = 10\nxi = np.linspace(xs.min(), xs.max(), cols * scaleFactor)\nyi = np.linspace(ys.min(), ys.max(), rows * scaleFactor)\nspline = scipy.interpolate.RectBivariateSpline(ys, xs, zs, kx=3, ky=3, s=0)\nzi = spline(yi, xi)\n\"\\ncoordinates = [(y, x) for y in ys for x in xs]\\nzs_flattened = np.ravel(zs, order='C')\\ncoordinates_interpolated = [(y, x) for y in yi for x in xi]\\n\\nzi_flattened= scipy.interpolate.griddata(coordinates, zs_flattened, coordinates_interpolated, method='cubic')\\n\\nzi = zi_flattened.reshape((rows*scaleFactor, cols*scaleFactor))\\n\"\nmin_threshold = 25\nzi[zi < min_threshold] = 0\nfig, ax = plt.subplots()\nplt.hist(zi.flatten(), 128, range=(min_threshold, zi.max()), fc='k', ec='k')\nplt.savefig('histogram.pdf', format='pdf')\nplt.close()\nfig, ax = plt.subplots()\ncmap = plt.get_cmap('bds_highcontrast')\ncax = ax.imshow(zi, cmap=cmap, vmin=zs.min(), vmax=zs.max(), origin='lower', extent=[xs.min(), xs.max(), ys.min(), ys.max()])\ncbar = fig.colorbar(cax)\ncbar.set_label('Raw sensor value', rotation=90)\ncbar.solids.set_edgecolor('face')\nax.invert_yaxis()\nax.xaxis.tick_top()\nplt.axis('off')\nplt.savefig('interpolation.pdf', format='pdf')\nplt.close()\nfig, ax = plt.subplots()\ncax = ax.imshow(zs, interpolation='nearest', cmap=plt.get_cmap('gray'), vmin=zs.min(), vmax=zs.max(), origin='lower', extent=[xs.min(), xs.max(), ys.min(), ys.max()])\ncountour_threshold = 50\nlevels = np.linspace(countour_threshold, zs.max(), 10)\ncontour = ax.contour(xi, yi, zi, levels, linewidths=1.0, colors=[(1.0, 0.0, 0.0)], origin='upper')\ncbar = fig.colorbar(cax)\ncbar.add_lines(contour)\ncbar.set_label('Raw sensor value', rotation=90)\ncbar.solids.set_edgecolor('face')\n'\\n\\nbackground = np.empty((rows, cols)); background.fill(0)\\ncax = ax.imshow(background, cmap=plt.get_cmap(\\'gray\\'), origin=\\'lower\\', extent=[xs.min(), xs.max(), ys.min(), ys.max()] )\\n\\ncountour_threshold = 100 # Ignore \"ripples\" from spline extrapolation\\nmax_threshold = 0 # Boost the upper limit to avoid truncation error\\nlevels = np.linspace(countour_threshold, zs.max(), num=10, endpoint=True)\\n\\nlevels[-1] = levels[-1] + (levels[-1] - levels[-2])/2\\n\\ncontour = ax.contourf(xi, yi, zi, levels=levels, cmap=plt.get_cmap(\\'bds_highcontrast\\'), origin=\\'upper\\')      \\n\\ncbar = fig.colorbar(contour, format=\\'%.0f\\')\\ncbar.set_label(\\'mV\\', rotation=0)\\ncbar.solids.set_edgecolor(\"face\") # set the color of the lines\\n\\n'\nax.invert_yaxis()\nax.xaxis.tick_top()\nplt.axis('off')\nplt.savefig('contour.pdf', format='pdf')\nplt.show()",
  "line_no": 29,
  "line_no_percent": "39%"
}