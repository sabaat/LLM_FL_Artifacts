{
  "instruction": "Create a program to perform a tf-idf calculation in Python.",
  "buggy_code": "import re\nfrom collections import Counter\n\ndef tf_idf(documents):\n    tokens = [tokenize(document) for document in documents]\n    vocabulary = get_vocabulary(tokens)\n    tf = get_termfrequency(tokens, vocabulary)\n    df = get_documentfrequency(tokens, vocabulary)\n    idf = get_inverse_documentfrequency(df, len(documents))\n    tf_idf = get_tf_idf(tf, idf)\n    return tf_idf\n\ndef tokenize(document):\n    tokens = re.findall(\"[\\\\w']+\", document)\n    return tokens\n\ndef get_vocabulary(tokens):\n    vocabulary = set()\n    for token_list in tokens:\n        vocabulary.update(set(token_list))\n    return vocabulary\n\ndef get_termfrequency(tokens, vocabulary):\n    tf = {word: [] for word in vocabulary}\n    for token_list in tokens:\n        counter = Counter(token_list)\n        for word in vocabulary:\n            tf[word] = tf[word] + [counter[word]]\n    return tf\n\ndef get_documentfrequency(tokens, vocabulary):\n    df = {word: 0 for word in vocabulary}\n    for token_list in tokens:\n        for word in vocabulary:\n            if word in token_list:\n                df[word] += 1\n    return df\n\ndef get_inverse_documentfrequency(df, num_documents):\n    idf = {word: 0 for word in df.keys()}\n    for word in df.keys():\n        idf[word] = math.log(num_documents / df[word])\n    return idf\n\ndef get_tf_idf(tf, idf):\n    tf_idf = {word: [] for word in tf.keys()}\n    for word in tf.keys():\n        scores = [tf[word][k] + idf[word] for k in range(len(tf[word]))]\n        tf_idf[word] = scores\n    return tf_idf",
  "line_no": 64,
  "line_no_percent": "128%"
}